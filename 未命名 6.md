# IIR 数字滤波器设计笔记

这份笔记基于《数字信号处理》课程第4章课件整理，涵盖了IIR滤波器设计的核心理论、方法步骤、公式推导及MATLAB实现。

## 1. 引论 (Introduction)

### 1.1 数字滤波器 (DF) 概念

- **定义**：一种离散时间系统，通过滤除输入信号中的特定频率成分来实现信号处理。
    
- **系统函数**：
    
    $$H(z) = \frac{\sum_{j=0}^{M} b_j z^{-j}}{1 + \sum_{i=1}^{N} a_i z^{-i}}$$
- **分类**：
    
    - **FIR (有限脉冲响应)**：$a_i$ 全为0，无反馈，必定稳定，易实现线性相位。
        
    - **IIR (无限脉冲响应)**：至少有一个 $a_i \neq 0$，有反馈，利用模拟滤波器设计，相位非线性。
        

### 1.2 IIR 滤波器设计基本思路

- **核心思想**：利用成熟的模拟滤波器设计理论，先设计模拟滤波器 $H(s)$，再转换为数字滤波器 $H(z)$。
    
- **==【考点】== 设计步骤**：
    
    1. **指标转换**：将数字滤波器指标 ($\Omega_p, \Omega_s$) 转换为模拟滤波器指标 ($\omega_p, \omega_s$)。
        
    2. **模拟设计**：设计满足指标的模拟滤波器 $H(s)$。
        
    3. **离散化**：将 $H(s)$ 映射为 $H(z)$ (脉冲响应不变法 或 双线性变换法)。
        

### 1.3 技术指标定义

- **频率指标**：
    
    - 通带截止频率：$\Omega_p$ (数字), $\omega_p$ (模拟)
        
    - 阻带截止频率：$\Omega_s$ (数字), $\omega_s$ (模拟)
        
- **幅度指标**：
    
    - 通带波纹 $\delta_p$，阻带波纹 $\delta_s$。
        
    - **衰减函数 (dB)**：
        
        $$A(\omega) = -20 \lg |H(j\omega)|$$
    - **==【考点】== 最大通带衰减** $A_p$：$A_p = -20 \lg(1-\delta_p)$
        
    - **最小阻带衰减** $A_s$：$A_s = -20 \lg(\delta_s)$
        

## 2. 模拟低通滤波器设计 (Analog Low-Pass Filter Design)

### 2.1 Butterworth (巴特沃斯) 滤波器 (BW型)

- **特点**：
    
    - 通带内幅频响应**最大平坦** (Maximally Flat)，单调下降。
        
    - $\omega=0$ 处 $1 \sim 2N-1$ 阶导数为零。
        
- **==【考点】== 幅度平方函数**：
    
    $$|H(j\omega)|^2 = \frac{1}{1+(\frac{\omega}{\omega_c})^{2N}}$$
    - $N$：阶数
        
    - $\omega_c$：3dB 截止频率 (此处衰减约3dB, $|H(j\omega_c)|^2 = 0.5$)
        
- **参数确定**：
    
    - **阶数** $N$ (取整数)：
        
        $$N \ge \frac{\lg(\frac{10^{0.1A_s}-1}{10^{0.1A_p}-1})}{2 \lg(\frac{\omega_s}{\omega_p})}$$
    - **3dB 截频** $\omega_c$：
        
        - 由通带确定：$\omega_c = \frac{\omega_p}{(10^{0.1A_p}-1)^{1/(2N)}}$
            
        - 由阻带确定：$\omega_c = \frac{\omega_s}{(10^{0.1A_s}-1)^{1/(2N)}}$
            
- **==【考点】== 极点分布**：
    
    - 极点总数 $2N$，均匀分布在 $s$ 平面半径为 $\omega_c$ 的圆上。
        
    - 极点角度：$s_k = \omega_c e^{j\pi(\frac{1}{2} + \frac{2k-1}{2N})}, \quad k=1, 2, ..., N$ (只取左半平面极点以保证稳定性)。
        
- **系统函数**：
    
    $$H(s) = \prod_{k=1}^{N} \frac{-s_k}{s - s_k}$$

### 2.2 Chebyshev I 型 (切比雪夫 I 型, CBI)

- **特点**：
    
    - **==【考点】== 通带等波纹** (Equiripple)，阻带单调下降。
        
    - 全极点系统。
        
- **幅度平方函数**：
    
    $$|H(j\omega)|^2 = \frac{1}{1+\epsilon^2 C_N^2(\frac{\omega}{\omega_c})}$$
    - $\epsilon$：控制通带波纹大小，$\epsilon = \sqrt{10^{0.1A_p}-1}$。
        
    - $C_N(x)$：Chebyshev 多项式 ($|x|\le 1$ 时为 $\cos(N \arccos x)$，波动；$|x|>1$ 时为 $\cosh(N \text{arccosh } x)$，单调)。
        
- **阶数** $N$：
    
    $$N \ge \frac{\text{arccosh}(\frac{1}{\epsilon}\sqrt{10^{0.1A_s}-1})}{\text{arccosh}(\frac{\omega_s}{\omega_p})}$$
- **极点分布**：分布在椭圆上。
    

### 2.3 Chebyshev II 型 (CB II)

- **特点**：
    
    - 通带单调下降，**==【考点】== 阻带等波纹**。
        
    - 既有极点又有零点。
        
- **幅度平方函数**：
    
    $$|H(j\omega)|^2 = 1 - \frac{1}{1+\epsilon^2 C_N^2(\frac{\omega_c}{\omega})} = \frac{\epsilon^2 C_N^2(\frac{\omega_c}{\omega})}{1+\epsilon^2 C_N^2(\frac{\omega_c}{\omega})}$$

### 2.4 椭圆滤波器 (Elliptic / Cauer)

- **特点**：
    
    - **==【考点】== 通带和阻带均为等波纹**。
        
    - **==【考点】== 阶数最低**：在满足相同指标下，椭圆滤波器的阶数 $N$ 最小，过渡带最窄。
        
    - **==【小众点】==**：极点离虚轴最近，不容易实现。
        
- **幅度平方函数**：
    
    $$|H(j\omega)|^2 = \frac{1}{1+\epsilon^2 R_N^2(\frac{\omega}{\omega_c})}$$
    
    ($R_N$ 为雅可比椭圆函数)
    

### 2.5 三种滤波器比较 (重点)

|类型|通带特性|阻带特性|过渡带|阶数 N|相位|
|---|---|---|---|---|---|
|**Butterworth**|最平坦|单调下降|最宽|最高|相对最好|
|**Chebyshev I**|等波纹|单调下降|较窄|中等|较差|
|**Elliptic**|等波纹|等波纹|最窄(陡峭)|**最低**|最差|

## 3. 模拟域频率变换 (Analog Frequency Transformation)

设计思路：先设计**归一化原型低通滤波器** ($H_L(\bar{s})$，$\bar{\omega}_p=1$)，再通过变换得到目标滤波器。

### 3.1 低通 $\to$ 高通 (LP $\to$ HP)

- **==【考点】== 变换公式**：
    
    $$\overline{s} = \frac{1}{s} \quad (\text{假设 } \overline{\omega}_p=1, \omega_p \text{为目标截止})$$
- **频率关系**：$\overline{\omega} = -1/\omega$
    
- **指标转换**：$\overline{\omega}_p = 1$, $\overline{\omega}_s = \frac{\omega_p}{\omega_s}$ (注意高通 $\omega_p > \omega_s$, 所以 $\overline{\omega}_s > 1$)。
    

### 3.2 低通 $\to$ 带通 (LP $\to$ BP)

- **参数**：
    
    - 带宽 $B = \omega_{p2} - \omega_{p1}$
        
    - 中心频率 $\omega_0^2 = \omega_{p1}\omega_{p2}$
        
- **变换公式**：
    
    $$\overline{s} = \frac{s^2 + \omega_0^2}{Bs}$$
- **频率关系**：$\overline{\omega} = \frac{\omega^2 - \omega_0^2}{B\omega}$
    
- **==【小众点/易错点】== 指标转换时的对称性**：
    
    - 由于模拟带通往往不对称，计算 $\overline{\omega}_s$ 时需取较小值以保证严格满足：
        
        $$\overline{\omega}_s = \min \left\{ \left| \frac{\omega_{s1}^2-\omega_0^2}{B\omega_{s1}} \right|, \left| \frac{\omega_{s2}^2-\omega_0^2}{B\omega_{s2}} \right| \right\}$$
- **阶数变化**：带通滤波器阶数是原型低通的 **2倍**。
    

### 3.3 低通 $\to$ 带阻 (LP $\to$ BS)

- **变换公式**：
    
    $$\overline{s} = \frac{Bs}{s^2 + \omega_0^2}$$
- **频率关系**：$\overline{\omega} = \frac{B\omega}{-\omega^2 + \omega_0^2}$
    
- **指标转换**：需取较大值：
    
    $$\overline{\omega}_s = \max \{...\}$$
    
    (此处原型低通的阻带边界应取绝对值较小的那个映射，但因为是带阻，通带映射到阻带，逻辑反转，需仔细对应)。
    
    - _修正_：根据PPT例题4-4逻辑，带阻通带对应原型的阻带，故应取 $\overline{\omega}_p = \max \{ |\overline{\omega}_{p1}|, |\overline{\omega}_{p2}| \}$。
        

## 4. 脉冲响应不变法 (Impulse Invariance Method)

### 4.1 基本原理

- **时域逼近**：使数字滤波器的单位脉冲响应 $h[k]$ 等于模拟滤波器冲激响应的采样值。
    
    $$h[k] = h(t)|_{t=kT}$$

### 4.2 变换关系

- **==【考点】== 极点映射**：
    
    $$s_i \longrightarrow z_i = e^{s_i T}$$
- **部分分式转换**：
    
    $$H(s) = \sum_{i=1}^{N} \frac{A_i}{s - p_i} \implies H(z) = \sum_{i=1}^{N} \frac{A_i}{1 - e^{p_i T}z^{-1}}$$
- **频率响应关系 (混叠公式)**：
    
    $$H(e^{j\Omega}) = \frac{1}{T} \sum_{n=-\infty}^{\infty} H(j(\frac{\Omega}{T} - \frac{2\pi n}{T}))$$
- **线性频率关系**：$\Omega = \omega T$ (在无混叠假设下)。
    

### 4.3 优缺点

- **优点**：频率是线性变换，保持了模拟滤波器的线性相位特性（如果模拟的有）。
    
- **==【考点】== 缺点**：
    
    - **频谱混叠 (Aliasing)**：如果 $H(j\omega)$ 不是带限的，高频部分会折叠到低频。
        
    - **局限性**：**不能**用于设计 **高通** 和 **带阻** 滤波器 (因为它们的高频部分不衰减，混叠严重)。
        

### 4.4 增益修正 (小众点)

- 为了消除 $1/T$ 的缩放因子，实际设计时通常将 $H(z)$ 乘以 $T$，或者在部分分式中直接乘 $T$。
    

## 5. 双线性变换法 (Bilinear Transformation Method)

### 5.1 基本原理

- 利用非线性频率压缩，将整个 $j\omega$ 轴 $(-\infty, \infty)$ 压缩到 $z$ 平面单位圆上 $(-\pi, \pi)$，彻底避免混叠。
    

### 5.2 变换公式

- **==【考点】== 代数变换**：
    
    $$s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}$$
    
    或者
    
    $$z = \frac{2/T + s}{2/T - s}$$

### 5.3 频率预畸变 (Pre-warping)

- **==【考点】== 非线性频率映射**：
    
    $$\omega = \frac{2}{T} \tan(\frac{\Omega}{2}) \quad \text{或} \quad \Omega = 2 \arctan(\frac{\omega T}{2})$$
    
    ($\omega$ 是模拟频率，$\Omega$ 是数字频率)
    
- **设计步骤**：
    
    1. **预畸变**：将数字指标 $\Omega$ 用 $\omega = \frac{2}{T} \tan(\frac{\Omega}{2})$ 转换为模拟指标 $\omega$。
        
    2. 设计模拟滤波器 $H(s)$。
        
    3. 代入 $s = \frac{2}{T} \frac{1 - z^{-1}}{1 + z^{-1}}$ 得到 $H(z)$。
        

### 5.4 优缺点

- **优点**：无混叠，适用于所有类型 (低通、高通、带通、带阻)。
    
- **缺点**：频率轴严重非线性压缩，高频部分畸变严重 (但在分段常数的滤波器设计中，通过预畸变可以解决截止频率对应的点，通常不影响幅频特性形状)。
    

## 6. MATLAB 设计方法

### 6.1 模拟滤波器设计函数

- `buttord`, `butter`: Butterworth
    
- `cheb1ord`, `cheby1`: Chebyshev I
    
- `cheb2ord`, `cheby2`: Chebyshev II
    
- `ellipord`, `ellip`: Elliptic
    
- **注意**：加上 `'s'` 参数表示设计模拟滤波器，否则默认设计数字滤波器。
    

### 6.2 频率变换函数

- `lp2hp`: 低通转高通
    
- `lp2bp`: 低通转带通
    
- `lp2bs`: 低通转带阻
    

### 6