
---

## 3. 模拟域频率变换 (非低通设计)

设计高通、带通、带阻时，先设计**归一化原型低通滤波器** ($H_L(\bar{s})$，$\bar{\omega}_p=1$)，再变换。

1. **低通 $\to$ 高通 (LP $\to$ HP)**
    
    - 变换公式：$\bar{s} = \frac{1}{s}$ 或 $\bar{\omega} = -1/\omega$。
        
    - **==[考点]==**：将低通的原点映射到高通的无穷远处。
        
2. **低通 $\to$ 带通 (LP $\to$ BP)**
    
    - 变换公式：$\bar{s} = \frac{s^2 + \omega_0^2}{Bs}$。
        
    - 参数：$B$ (带宽)，$\omega_0$ (中心频率 $\sqrt{\omega_{p1}\omega_{p2}}$)。
        
    - **==[考点/难点]==**：由于模拟带通往往不对称，映射到原型低通时，阻带截频 $\bar{\omega}_s$ 需取 $\min(|\bar{\omega}_{s1}|, |\bar{\omega}_{s2}|)$ 以保证严谨满足指标。
        
    - 阶数变化：带通滤波器阶数是原型低通的 **2 倍**。
        
3. **低通 $\to$ 带阻 (LP $\to$ BS)**
    
    - 变换公式：$\bar{s} = \frac{Bs}{s^2 + \omega_0^2}$。
        
    - **==[考点/难点]==**：映射到原型低通时，阻带截频 $\bar{\omega}_p$ 需取 $\max(|\bar{\omega}_{p1}|, |\bar{\omega}_{p2}|)$。
        

---

## 4. 模拟 $\to$ 数字滤波器转换方法 (核心考点)

### 4.1 脉冲响应不变法 (Impulse Invariance Method)

1. **原理**：时域逼近。使数字滤波器的单位脉冲响应 $h[k]$ 等于模拟滤波器响应的采样 $h(kT)$。
    
2. **映射关系**：$z = e^{sT}$。
    
    - $s$ 平面左半平面 $\to$ $z$ 平面单位圆内。
        
    - 线性频率关系：$\omega = \Omega / T$。
        
3. **缺点 (致命弱点)**：
    
    - **==[考点]== 频谱混叠 (Aliasing)**：模拟滤波器的频响不是带限的，采样后高频部分会折叠到低频。
        
    - **适用性**：仅适用于**低通**和**带通**。
        
    - **==[考点]==**：绝对**不能**用于设计高通和带阻滤波器 (因为高频部分不衰减，混叠严重)。
        
4. **==[小众点]== 增益修正**：通常需要乘以 $T$，以消除采样带来的幅度 $1/T$ 缩放，即 $H(z) \approx T \cdot H(s)$。
    

### 4.2 双线性变换法 (Bilinear Transformation Method)

1. **原理**：通过非线性频率压缩，将整个 $j\omega$ 轴压缩到单位圆上，避免混叠。
    
2. **映射关系**：$s = \frac{2}{T} \frac{1-z^{-1}}{1+z^{-1}}$。
    
3. **频率预畸变 (Pre-warping) ==[核心考点]==**：
    
    - 模拟频率 $\omega$ 与数字频率 $\Omega$ 是非线性正切关系。
        
    - 公式：$\omega = \frac{2}{T} \tan(\frac{\Omega}{2})$。
        
    - **设计步骤**：先将数字指标 $\Omega$ 用上述公式“预畸变”为模拟指标 $\omega$，设计模拟滤波器，最后代入变换公式。
        
4. **优缺点**：
    
    - 优点：无混叠，适用于所有类型 (LP, HP, BP, BS)。
        
    - 缺点：频率轴是非线性的，高频部分压缩严重 (但在分段常数的滤波器设计中影响不大)。
        

---

## 5. MATLAB 设计与实现

1. **常用函数**：
    
    - `buttord` / `butter`：巴特沃斯设计。
        
    - `cheb1ord` / `cheby1`：切比雪夫 I 型。
        
    - `ellipord` / `ellip`：椭圆滤波器。
        
2. **转换函数**：
    
    - `impinvar(num, den, Fs)`：脉冲响应不变法。
        
    - `bilinear(num, den, Fs)`：双线性变换法。
        
3. **模拟域变换函数**：
    
    - `lp2hp`, `lp2bp`, `lp2bs`：将模拟低通原型转换为其他类型。
        
4. **==[小众点]== 注意事项**：MATLAB 中的 `butter` 等函数若不加参数 `'s'`，默认设计的是数字滤波器 (即内部自动包含了双线性变换步骤)；加上 `'s'` 才是设计模拟滤波器。
    

---

## 6. 应用实例：脉搏信号处理

1. **信号特征**：
    
    - 有效频率：1 Hz ~ 20 Hz。
        
    - 主要噪声：
        
        - 基线漂移 (0 ~ 1 Hz)。
            
        - 工频干扰 (50 Hz)。
            
        - 高频肌电干扰 (>20 Hz)。
            
2. **滤波方案**：
    
    - **方案一**：设计一个通带为 [1 Hz, 20 Hz] 的带通滤波器。
        
    - **方案二 (级联)**：设计一个截止频率 1 Hz 的高通 (去基线漂移) + 一个截止频率 20 Hz 的低通 (去高频)。
        
    - **对比**：方案二级联方式调试更灵活；BW 型相位较好，CB 型阶数更低但波形可能有失真。
        

---

## 7. 考前速记表

|**比较项目**|**脉冲响应不变法**|**双线性变换法**|
|---|---|---|
|**频率映射**|线性 $\omega = \Omega/T$ |非线性 $\omega = \frac{2}{T}\tan(\frac{\Omega}{2})$ |
|**频谱混叠**|**有** (严重缺陷)|**无** (主要优势)|
|**适用范围**|仅限带限信号 (低通/带通)|所有类型 (低/高/带通/带阻)|
|**s 平面映射**|多条带状区域映射到单位圆内|整个左半平面单值映射到单位圆内|
|**设计核心**|保持 $h(t)$ 采样值不变|保持代数转换关系|
