特别注意符号的意义。确实符号太多了。容易混乱
0. 回忆：连续非周期信号 $x (t)$ 的频谱是 $X (j\omega)$, 离散非周期信号 $x[k]$ 的频谱是 $X (e^{j\Omega})$ ，理论上这两种信号可以实现时域到频域的转换，但是工程应用中由于 $x (t)$ 的表达式一般不存在，  $x[k]$ 的频谱 $X (e^{j\Omega})$ 是连续谱，所以也无法用数字化的方法来计算 $$\begin{array}{rcl}x(t) \\x[k] \end{array}\xrightarrow[\text{FT}]{\text{理论上}}\begin{array}{rcl}X(j\omega) \\X(e^{j\Omega})\end{array}$$ 之后引入 DFT 作为四种信号傅立叶变换的数字化实现（离散化实现），是一个方法不是一个新的变换 $$x(t) \xrightarrow{\text{理论上} \quad \text{FT}} X(j\omega) \quad \text{或} \quad x[k] \xrightarrow{\text{理论上} \quad \text{FT}} X(e^{j\Omega}) \quad \text{；实践中：} \quad x[k] \xrightarrow{\text{方法上} \quad \text{DFT}} X[m]$$ 可以用 $x[k]$ 的 DFT 来近似估算 4 种信号的频谱，他和 DFS 在一个周期里面是完全一致的。DFT 从方法上可以用来估算其他种类型信号的频谱（连续非周期信号和离散序列的频谱）
	1. DFT 计算量：
		- DFT 定义：$X[m] = \sum_{k=0}^{N-1} x[k] W_N^{mk}$
		- **复杂度**：计算一个 $N$ 点序列的 DFT，需要 $N^2$ 次复数乘法和 $N(N-1)$ 次复数加法。
		- **瓶颈**：当 $N$ 很大时，计算量急剧增加，无法满足实时处理需求。![[截屏2025-12-01 21.38.49.png|300]]
	2. DFT 应用：
		1. 分析信号通过系统的响应算卷积
		2. 分析信号的频谱
1. FFT：%% 各种 DFT 快速算法的总称，不只是指一个算法，是用来提高DFT 效率的所有算法集合 %%
	1. **FFT 的贡献**：从根本上使得信号傅立叶变换得以应用
	    - 1965 年，Cooley 和 Tukey 提出了快速算法。
	    - **【考点】** 效率提升：将复数乘法次数从 $N^2$ 降低到 $\frac{N}{2}\log_2 N$。例如 $N=2048$ 时，运算量仅为直接计算的 0.27%; 且降低了 DFT 运算带来的累计量化误差 $$\begin{align*}X[k] & \xrightarrow[\text{\textcolor{myblue}{DFT}}]{\text{\textcolor{mypurple}{方法上}}} X[m] \\[1.5 em] X[k] & \xrightarrow[\text{\textcolor{myblue}{FFT}}]{\text{\textcolor{mypurple}{技术上}}} X[m]\end{align*}$$
	2. 核心思想：分治法 (Divide and Conquer)
		1. 将**长序列**的 DFT 分解为**短序列**的 DFT
		2. 思想能够实现的原理：利用旋转因子 $W_N^{mk}$ 的三大特性（🧚‍♀️这里的表达式就是之前讲过的那个虚数圆）（旋转因子那个 $N$ 是可以带入数值的）
			0. 旋转因子： $W_N = e^{-j\frac{2\pi}{N}}$
				1. 几何意义：在复平面上，$W_N$ 代表单位圆上的一个向量。
					1. **模长**：始终为 1。
					2. **角度**：$W_N^1$ 代表从实轴（角度为0）开始，**顺时针**旋转 $\frac{2\pi}{N}$ 弧度（即 $360/N$ 度）。
					3. **$W_N^{km}$**：代表顺时针旋转了 $k \times m$ 个 $\frac{2\pi}{N}$ 的步长。
				2. $W_N^{mk}$：
					1. DFT 公式 $X[m] = \sum_{k=0}^{N-1} x[k] W_N^{mk}$ 
					2. 作用：充当了将时域信号投影到频域的“基函数”的作用
					3. $k$ ：“离散时间索引”
						1. $k$ 对应于输入信号 **$x[k]$**（时域序列）
						2. $k$ 指示的是第几个采样点。例如，$x[0]$ 是第 0 个采样点，$x[1]$ 是第 1 个采样点。
						3. 取值范围：$0, 1, \dots, N-1$
						4. **$k$ 在求和符号里**：表示公式要把时域中所有 $N$ 个时间点的数据累加起来。
					4. $m$ ：“离散频率索引”
						1. 输出结果 **$X[m]$**（频域序列）
						2. $m$ 指示的是第几个频率分量（也称为谱线或频率仓 Frequency Bin）。
						3. $m$ 对应的实际频率为 $\omega_m = \frac{2\pi m}{N}$（数字角频率）或 $f_m = \frac{m}{N} f_s$（赫兹，其中 $f_s$ 是采样率）。
						4. 取值范围：$0, 1, \dots, N-1$。
			1. **周期性**：$W_N^{k+N} = W_N^k$ ；$W_N^{(k+N)m} = W_N^{k(m+N)} = W_N^{km} \\[1em]$
			2. **对称性**：$W_N^{k+N/2} = -W_N^k$；$W_N^{mk+\frac{N}{2}} = -W_N^{mk}$；$\left(W_N^{km}\right)^* = W_N^{-mk} \\[1em]$ ==> $W_N^{N/2} = -W_N^0= -1$ 🧚‍♀️欧拉公式代入得-1
			3. **可约性**：$W_N^{mk} = W_{N/m}^{k}$ (当 $N$ 是 $m$ 的倍数时即底数的 $N$ 和指数的 $mk$ 必须同时拥有公因子 $m$)； $W_N^{mk} = W_{MN}^{Mmk}$；$W_N^{mk} = W_{N/M}^{mk/M}, \quad N/M\text{为整数}$
		3. 为什么可以提高计算效率（降低复数乘法的次数）
			1. 计算 $N$ 点序列的 DFT 需要复数乘法 $N^2$ ![[截屏2025-12-01 21.51.31.png|300]] 
			2. 分解之后可以将复数乘法降低一半🧚‍♀️等于说串行改并行，面积换速度了
			3. 如果通过短序列的 DFT 可以很简单的表示出长序列的 DFT 方法就是有效的，如果运算量很大这个思想就无法实现，由于旋转因子具有周期性、对称性和可约性，用两个短序列 DFT 表示长序列的 DFT 几乎没有增加运算量🧚‍♀️类似于快速幂
			4. 可以进一步往下分，效率会不断增加
2. 基2 **时间抽取** FFT (DIT-FFT)（库利图基）
	0. **前提**：序列长度 $N = 2^M$。如果不满足，通常补零。
	1. 算法原理
		1. **时间抽取**：将时域序列 $x[k]$ 按**奇偶**下标分解，每隔一个点抽一个点 (🧚‍♀️可以理解为从原序列进行抽样)
			1. 偶数点序列：$x_1[k] = x[2k]$
			2. 奇数点序列：$x_2[k] = x[2k+1]$
		2. 推导核心公式【考点】
			1. $X[m] = X_1[m] + W_N^m X_2[m]$ $0 \le m \le N/2 - 1$
				1. 用短序列 DFT 表示长序列 DFT
				2. 两个短序列长度是 $N/2$，$X_1[m]$ 和 $X_2[m]$ 的 $m$ 的取值只能是 0 到 $N/2-1$，但是 $X[m]$ 的 $m$ 值是 0 到 $N-1$，是 $N$ 个点的值
			2. $X[m + N/2] = X_1[m] - W_N^m X_2[m]$ $0 \le m \le N/2 - 1$ --> $N/2 \le m+N/2 \le N-1$
				0. 前提：DFT 是 DFS 在一个周期内的取值，$N$ 点的 DFT 一定隐含了以 $N$ 为
				1. 周期性
				2. 证明：令 $X[m] = X_1[m] + W_N^m X_2[m]$ 的 $m=m+N/2$，$X[m+N/2] = X_1[m+N/2] + W_N^{m+N/2} X_2[m+N/2]$ 由于 $X_1[m]$ 和 $X_2[m]$ 隐含以 $N/2$ 为周期的周期性==> $X[m+N/2] = X_1[m] -W_N^m X_2[m]$ 🧚‍♀️ $X[m]$ 因为前面转化为 $N/2$ 点DFT ,所以要补上另外一半；$\sum_{k=0}^{N/2-1} x[2k+1] W_N^{(2k+1)m} = \underbrace{W_N^m}_{\text{提到前面}} \sum_{k=0}^{N/2-1} x[2k+1] \underbrace{W_{N/2}^{km}}_{\text{约分后}}$ 
					- **物理/几何意义**： DFT 具有**时移性质**：$x[n-n_0] \leftrightarrow X[m]W_N^{mn_0}$。奇数项序列 $x[2k+1]$ 相对于偶数项序列 $x[2k]$，在时间轴上滞后了 **1 个单位**。因此，在频域合成时，必须乘上一个线性相移因子 $W_N^{m \cdot 1}$ 来补偿这个时间差。**频域的相位旋转** $\Leftrightarrow$ **时域的时间位移。**
				- 其中 $X_1[m]$ 和 $X_2[m]$ 分别是 $N/2$ 点的 DFT。
				- $m$ 的取值范围：$0 \le m \le N/2 - 1$
			![[截屏 2025-12-01 23.21.46.jpeg]] ![[Pasted image 20251201234452.png]] **3 种方式表示用短序列 DFT 表示长序列 DFT**🧚‍♀️矩阵计算机好实现吧，数组列表啥的很方便
	2. 蝶形运算
		1.  4 点序列FFT 流图：4 点序列表示成两个 2 点序列 ![[3.1 FFT概述.jpeg]] [FFT 流图]4 点序列表示成两个 2 点序列
		2. 8 点序列FFT 流图
			1. 步骤一 ：再奇偶抽取 ![[3.1 FFT概述 2.jpeg]]
			2. 步骤二 ：![[Gemini_Generated_Image_q6840zq6840zq684.png]]
			3. 步骤三：非常对称，好像整张图都是在合成，但其实第一级是在算 DFT 的，后面是合成![[截屏2025-12-02 10.00.11.png]] - 为了和后面的看着一样，第一列配了一个 $W_8^0$ 、$W_8^0$、$W_8^0$、$W_8^0$，便于程序实现 $W_8^0=1$
			4. 特点：$N=8 ,log_2^N=3$  基 2 时间抽取点数一定是 2 的幂次方
				![[截屏2025-12-02 10.02.22.png]]
				1. 第一级：时域的序列转换为对应的 DFT 值
				2. 第二级：两个两点序列合成一个四点序列的 DFT
				3. 第三级：两个四点序列的 DFT 合成一个八点序列的 DFT
					-  $W_8^2$ 就是 $W_4^1$, 利用旋转因子的可约性统一形式
					- 后面两级是短序列合成长序列 DFT
					- 两个短序列合成长序列的 DFT 和时域上两点序列计算 DFT的矩阵是一样的，所以整个流程图完全对称，都是 $\begin{bmatrix}1 & 1 \\1 & -1\end{bmatrix}$
				- 【总结】基 2 时间抽取 FFT 算法的思想是将长序列 DFT 分解成短序列DFT，具体是将一个长序列分解成两个短序列（按照奇偶下标拆分），分解之后再用短序列 DFT 合成长序列 DFT（有两个表达式），要求点数 $N$ 是 $2$ 的幂次方第一级是通过 2 点时域序列算 DFT，后面逐级合成达到需要的 $x[k]$ 的DFT
				- 【算法流图特点】 ![[fft_butterfly_2.png]] ![[fft_butterfly_4.png]] ![[fft_butterfly_8.png]] ![[fft_butterfly_16.png]]
					1. 基本单元：第一级蝶形图间隔是 1，第二级蝶形图间隔是 2，第三级蝶形图间隔是 4... 
					2. 旋转因子：8点举例，最后一级（4点序列合成 8 点序列）是 $W_8^0 W_8^1 W_8^2 W_8^3$，第二级（2 点序列合成 4 点序列）本来是 $W_4^0 W_4^1$ 为了整体统一，利用旋转因子的可约性变成 $W_8^0 W_8^2$![[截屏2025-12-02 14.26.18.png]]![[Pasted image 20251202142229.png]]
		3. **结构**：FFT 的基本计算单元。![[Pasted image 20251202142832.png]] ![[截屏2025-12-02 14.29.28.png]] ![[截屏2025-12-02 14.30.42.png]]
			- 两个输入 ($X_1[m], X_2[m]$) -->两个输出 ($X[m], X[m+N/2]$)。
			- 原位运算：输入序列是 8 点序列，整个运算过程中始终占据 8 个位置，第一级结果自动覆盖输入序列，后面也是依次类推【fft 算法结构的优越性】🧚‍♀️节省存储空间；拿递归做的，想想空间复杂度的差距吧
			   	    - 例如：对一个数据采样，$1 s$ 采 $20 k$ 即 $1 s$ 采 $2$ 万数据，$10 s$ 就是 $20$ 万数据，所以工程类信号算 DFT 具有结构优越性很有价值
		4. **运算量**：一个蝶形运算包含 **1次复数乘法** 和 **2次复数加法**。
			- _注：虽然图上有两个箭头，但_ $W_N^m$ _只乘一次，另一路利用对称性直接变号。_
	3. 算法复杂度分析 **【考点】**
		1. **蝶形运算**的计算量：![[截屏2025-12-02 14.38.20.png]]
			1. 复数乘法：1 次 $W_N^mX_2[m]$
			2. 复数加法:   2 次
		2. **级数**：共 $M = \log_2 N$ 级
		3. **每级蝶形数**：$N/2$ 个。
		4. **总运算量**：
			1. **复数乘法**：$\frac{N}{2} \log_2 N$ (DFT 直接计算次数  $N^2$) ![[截屏2025-12-02 14.47.33.png|200]]
			2. **复数加法**：$N \log_2 N$ (DFT 直接计算次数$N(N-1)$)
			- 由于复数乘法时间比加法运算时间长，一般关注乘法（但其实现在高速芯片加法乘法时间差不多）![[Pasted image 20251202145415.png]]
		5. **复杂度对比**：$O(N \log N)$ vs $O(N^2)$ 点数$N$越多，fft 算法效率越明显
		6. 最后一级是 2 点序列的 DFT，实现频域到时域的转换；其他运算都是用短序列 DFT 合成长序列 DFT（1 点序列的 DFT 就是它本身）
			1. 2 点序列的 DFT：$X[m] = \sum_{k=0}^{N-1} x[k] W_N^{mk}, \quad m=0, 1, \dots, N-1$
				1. **$m=0$  (直流分量)**：$X[0] = x[0] \cdot W_2^0 + x[1] \cdot W_2^0 = x[0] + x[1]$ -->信号的“和”，代表信号的平均值（直流分量）。
				2. **$m=1$  (奈奎斯特频率分量)**：$X[1] = x[0] \cdot W_2^0 + x[1] \cdot W_2^1 = x[0] - x[1]$ -->信号的“差”，代表信号中**变化最快**的分量（高频分量）。
			2. 2点 DFT **核心矩阵**： $\begin{bmatrix}1 & 1 \\1 & -1\end{bmatrix}$ 是基2-FFT算法中最基本的运算单元。
3. 基2 频率抽取 FFT (DIF-FFT)
	0. 算法思想：都是将长序列拆分为短序列 DFT，但是拆分方法不同（奇偶下标/）
	1. 算法原理
		- **时域处理**：将时域序列 $x[k]$ 分为**前半部分**和**后半部分**
			-  
		- 频率抽取**：将频域序列 $X[m]$ 分为偶数项 $X[2r]$ 和奇数项 $X[2r+1]$
		- **推导核心公式**：
		    - 偶数频率：$X[2r] = \text{DFT}_{N/2} \{ x[k] + x[k+N/2] \}$
		    - 奇数频率：$X[2r+1] = \text{DFT}_{N/2} \{ (x[k] - x[k+N/2]) W_N^k \}$
	2. 算法特点（与 DIT 对比） **【考点】**

| 特性       | DIT (时间抽取)          | DIF (频率抽取)          |
| -------- | ------------------- | ------------------- |
| **分解方式** | 时域奇偶分解              | 频域奇偶分解 / 时域前后分解     |
| **输入顺序** | **倒序**              | **自然顺序**            |
| **输出顺序** | **自然顺序**            | **倒序**              |
| **蝶形结构** | 乘法在加减法**之前** (输入端乘) | 乘法在加减法**之后** (输出端乘) |
| **运算量**  | 相同                  | 相同                  |

4. 其他基与混合基 FFT **【小众点】**
	1. 基4 FFT
		- **前提**：$N = 4^M$。
		- **原理**：将序列分为 4 组。
		- **优势**：
		    - 基4蝶形运算不需要计算 $W_N^0, W_N^{N/4} (-j), W_N^{N/2} (-1)$ 等旋转因子。
		    - **运算量**：复数乘法次数约为 $\frac{3}{8} N \log_2 N$。
		    - **结论**：比基2 FFT 效率更高（减少了约 25% 的乘法）。
		- **系数矩阵**：利用单位圆四等分生成。
	2. 基3 FFT
		- **前提**：$N = 3^M$。
		- **原理**：将序列分为 3 组。
		- **旋转因子**：涉及 $a = -\frac{1}{2} - j\frac{\sqrt{3}}{2}$ 和 $b = -\frac{1}{2} + j\frac{\sqrt{3}}{2}$。
	3. 混合基 FFT (Composite Radix)
		- **应用场景**：当 $N \neq 2^M$ 时（例如 $N=12$）。
		- **方法**：将 $N$ 分解为 $p \times q$。
		- **流程**：先做 $p$ 组 $q$ 点 DFT，再合成。
		- **意义**：避免了大量补零带来的效率损失。
	4. 算法对称性 **【小众点】**
		- DIT 的频域合成系数矩阵 = DIF 的时域分解系数矩阵。
		- 两者流图结构在数学上具有转置或对称关系。
5. FFT 的典型应用 **【核心考点 & 计算题重灾区】**
	1. IDFT 的快速计算
		- **原理**：IDFT 公式与 DFT 极其相似，仅旋转因子指数符号不同且多一个 $1/N$。
		- **方法1**：直接修改 FFT 程序，将 $W_N$ 改为 $W_N^{-1}$，最后乘 $1/N$。
		- **方法2（利用现有 FFT 程序）** **【技巧】**：$x[k] = \frac{1}{N} [\text{FFT}(X^*[m])]^*$
		    - 步骤：
		        1. 对 $X[m]$ 取共轭。
		        2. 进行 FFT 运算。
		        3. 对结果取共轭。
		        4. 除以 $N$。
	2. 用一次 N 点复数 FFT 计算两个 N 点实序列的 DFT
		- **场景**：有两个实序列 $x_1[k]$ 和 $x_2[k]$。
		- **方法**：
		    1. 构造复序列：$y[k] = x_1[k] + j x_2[k]$。
		    2. 计算 $Y[m] = \text{FFT}(y[k])$。
		    3. 利用共轭对称性分离频谱：$X_1[m] = \frac{1}{2} \{ Y[m] + Y^*[(N-m)_N] \}$, $X_2[m] = \frac{1}{2j} \{ Y[m] - Y^*[(N-m)_N] \}$
		- **效率**：运算效率提高一倍。
	3. 用一次 N 点复数 FFT 计算一个 2N 点实序列的 DFT
		- **场景**：处理一个长为 $2N$ 的实序列 $x[k]$。
		- **方法**：
		    1. 将 $x[k]$ 按奇偶拆分为两个 $N$ 点实序列： $g[k] = x[2k]$ (偶分量), $h[k] = x[2k+1]$ (奇分量)。
		    2. 构造 $N$ 点复序列 $y[k] = g[k] + j h[k]$。
		    3. 计算 $N$ 点 FFT 得到 $Y[m]$。
		    4. 分离出 $G[m]$ 和 $H[m]$ (同 5.2 的方法)。
		    5. 利用 DIT 蝶形公式合成 $2N$ 点 DFT：
		        $X[m] = G[m] + W_{2N}^m H[m]$, $X[m+N] = G[m] - W_{2N}^m H[m]$ 
		        _(注意：这里_ $m$ _范围是_ $0 \dots N-1$_)_
	4. 利用 FFT 计算线性卷积（系统响应） **【重要考点】**
		- **原理**：时域的**圆周卷积**对应频域相乘。为了利用 DFT 计算**线性卷积**，必须对序列进行**补零**，使其圆周卷积的结果等同于线性卷积。
		- **条件**：若信号 $x[n]$ 长度为 $N$，系统脉冲响应 $h[n]$ 长度为 $M$，则线性卷积结果长度为 $L_{lin} = N+M-1$。进行 FFT 的点数 $L$ 必须满足：
		    $$L \ge N+M-1$$
		    
		    通常取 $L$ 为 2 的幂次以便使用 FFT。
		- **步骤**：
		    1. **补零**：将 $x[n]$ 和 $h[n]$ 补零至长度 $L$。
		    2. **FFT**：计算 $X[k] = \text{FFT}(x)$ 和 $H[k] = \text{FFT}(h)$。
		    3. **相乘**：计算 $Y[k] = X[k] \cdot H[k]$。
		    4. **IFFT**：计算 $y[n] = \text{IFFT}(Y[k])$。
		- **举例**：
		    - **输入**：信号 $x[n] = \{1, 2\}$ ($N=2$)，系统 $h[n] = \{2, 1\}$ ($M=2$)。
		    - **目标**：求线性卷积 $y[n] = x[n] * h[n]$。
		    - **直接计算**：
		        - $n=0: 1\times2 = 2$
		        - $n=1: 1\times1 + 2\times2 = 5$
		        - $n=2: 2\times1 = 2$
		        - 结果 $y[n] = \{2, 5, 2\}$。
		    - **FFT 方法**：
		        1. **补零**：卷积长度 $2+2-1=3$，取 $L=4$ (2的幂)。 $x'[n] = \{1, 2, 0, 0\}$ $h'[n] = \{2, 1, 0, 0\}$
		        2. **DFT**： $X[k] = \text{DFT}\{x'\} = \{3, 1-2j, -1, 1+2j\}$ $H[k] = \text{DFT}\{h'\} = \{3, 2-j, 1, 2+j\}$
		        3. **频域相乘**： $Y[k] = X[k]H[k] = \{9, -5j, -1, 5j\}$ _(例如_ $k=1$_:_ $(1-2j)(2-j) = 2 - j - 4j + 2j^2 = -5j$_)_
		        4. **IDFT**： 对 $Y[k]$ 做 4点 IDFT，得到 $y[n] = \{2, 5, 2, 0\}$。 前 3 点即为线性卷积结果，与直接计算一致。
## 6. 总结与备考指南

- **必须掌握的图**：能画出 $N=4$ 和 $N=8$ 的基2 DIT-FFT 和 DIF-FFT 信号流图（注意箭头方向、权重位置、输入输出顺序）。
    
- **必须记住的公式**：
    
    - 蝶形运算公式。
        
    - 复杂度 $\frac{N}{2}\log_2 N$。
        
    - 实序列 DFT 的分离公式（5.2 节）。
        
- **易错点**：
    
    - DIT 是倒序输入，DIF 是倒序输出。
        
    - IDFT 计算时不要忘记除以 $N$。
        
    - 计算 $Y^*[(N-m)_N]$ 时，注意下标是模 $N$ 运算（即 $Y^*[0]$ 对应 $Y^*[0]$， $Y^*[1]$ 对应 $Y^*[N-1]$）。