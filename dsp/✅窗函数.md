# 窗函数法设计 FIR 滤波器 (Window Method Design) 解题指南

## 1. 核心解题步骤 (五步法)

无论题目怎么变，解题逻辑永远遵循以下五个步骤：

### 第一步：指标归一化 (数字化)

题目通常给出模拟频率（$Hz$ 或 $rad/s$），必须先转化为数字频率 $\omega$ (单位：$rad$)。

- **关系式**：
    
    $$\omega = \frac{2\pi f}{f_s} = \Omega \cdot T$$
    - $f$: 模拟频率 ($Hz$)
        
    - $f_s$: 采样频率 ($Hz$)
        
    - $\Omega$: 模拟角频率 ($rad/s$)
        
    - $T$: 采样间隔 ($s$)
        
- **计算目标**：
    
    - 通带截止频率 $\omega_p$
        
    - 阻带截止频率 $\omega_{st}$ (或 $\omega_s$)
        

### 第二步：计算过渡带宽度与截止频率

- **过渡带宽度 (**$\Delta\omega$**)**：
    
    $$\Delta\omega = |\omega_{st} - \omega_p|$$
- **理想截止频率 (**$\omega_c$**)**： 一般取通带和阻带的中心：
    
    $$\omega_c = \frac{\omega_p + \omega_{st}}{2}$$

### 第三步：选择窗函数 & 确定阶数 N

根据题目要求的**最小阻带衰减 (**$A_s$ **或** $\alpha_s$**)**，查表选择窗函数，并利用过渡带宽度公式计算滤波器长度 $N$。

**必背表格 (考试通常会给出部分参数，但建议背诵以防万一)**

|窗函数类型 (Window)|阻带最小衰减 (dB)|过渡带宽度近似公式 ($\Delta\omega$)|
|---|---|---|
|**矩形窗 (Rectangular)**|-21 dB|$1.8\pi / N$ (或 $4\pi/N$)|
|**汉宁窗 (Hanning)**|-44 dB|$6.2\pi / N$ (或 $8\pi/N$, 题目中常给 $3.1 \times \frac{2\pi}{N}$)|
|**哈明窗 (Hamming)**|**-53 dB (最常用)**|$6.6\pi / N$ (或 $8\pi/N$, 题目中常给 $3.3 \times \frac{2\pi}{N}$)|
|**布莱克曼窗 (Blackman)**|-74 dB|$11\pi / N$ (或 $12\pi/N$, 题目中常给 $5.5 \times \frac{2\pi}{N}$)|

- **选择逻辑**：选择满足衰减指标且阶数最低（主瓣最窄）的窗。例如要求 $-50dB$，汉宁窗(-44)不够，必须选哈明窗(-53)。
    
- **计算** $N$：利用公式 $\Delta\omega = \frac{C \cdot 2\pi}{N}$ 反解 $N$。
    
    - **注意**：$N$ 必须是整数，且为了保证线性相位（通常题目要求Type I），建议取**奇数**。如果算出 $32.1$，取 $33$；如果算出 $32$，通常也建议取 $33$ 以获得更好的性能或满足题目特定的偶对称中心要求。
        

### 第四步：构造理想滤波器 $h_d(n)$

根据滤波器类型（低通、高通等）写出理想单位脉冲响应 $h_d(n)$。 设 $\tau = \frac{N-1}{2}$ 为延迟中心（对称中心）。

- **低通 (Low Pass)**:
    
    $$h_d(n) = \frac{\sin[\omega_c (n-\tau)]}{\pi (n-\tau)}$$
    
    (当 $n=\tau$ 时，利用洛必达法则，$h_d(\tau) = \frac{\omega_c}{\pi}$)
    
- **高通 (High Pass)**:
    
    $$h_d(n) = \delta(n-\tau) - \frac{\sin[\omega_c (n-\tau)]}{\pi (n-\tau)}$$
    
    (即：全通 - 低通)
    

### 第五步：得出最终表达式 $h(n)$

$$h(n) = h_d(n) \cdot w(n), \quad 0 \le n \le N-1$$

- 其中 $w(n)$ 是你选择的窗函数表达式（如哈明窗：$0.54 - 0.46\cos(\frac{2\pi n}{N-1})$）。
    
- **作答格式**：通常只需要写出解析表达式即可，除非 $N$ 很小（如 $N=5$），否则不需要计算每个点的具体数值。
    

## 2. 真题实战演练

### 案例 1：2018年 第13题 (低通设计)

**题目摘要**： $\Omega_{sam} = 3\pi \times 10^4 rad/s$, 通带 $\Omega_p = 3\pi \times 10^3$, 阻带 $\Omega_s = 6\pi \times 10^3$, 阻带衰减 $\ge -50dB$。设计线性相位FIR低通滤波器。

**解题过程**：

1. **数字化**： 采样频率 $\Omega_{sam} = 30000\pi$。
    
    $$\omega_p = \frac{\Omega_p}{\Omega_{sam}} \cdot 2\pi = \frac{3000\pi}{30000\pi} \cdot 2\pi = 0.2\pi$$$$\omega_s = \frac{\Omega_s}{\Omega_{sam}} \cdot 2\pi = \frac{6000\pi}{30000\pi} \cdot 2\pi = 0.4\pi$$
2. **计算参数**：
    
    - 过渡带宽度 $\Delta\omega = \omega_s - \omega_p = 0.2\pi$
        
    - 理想截止频率 $\omega_c = \frac{0.2\pi + 0.4\pi}{2} = 0.3\pi$
        
3. **定窗与定阶**：
    
    - 指标要求 $-50dB$。查表（试卷中给出了表）：
        
        - 汉宁窗：-44dB (不满足)
            
        - 哈明窗：-53dB (满足) -> **选择哈明窗 (Hamming)**
            
    - 计算 $N$： 根据表中哈明窗过渡带公式：$\Delta\omega \approx \frac{3.3 \times 2\pi}{N}$ (注：不同年份公式系数略有不同，以卷面为准，若无卷面则按 $6.6\pi/N$ 估算)。
        
        $$0.2\pi = \frac{6.6\pi}{N} \implies N = \frac{6.6}{0.2} = 33$$
    - 取 $N=33$。
        
    - 对称中心 $\tau = \frac{N-1}{2} = \frac{33-1}{2} = 16$。
        
4. **理想响应**： 低通滤波器：
    
    $$h_d(n) = \frac{\sin[0.3\pi (n-16)]}{\pi (n-16)}$$
5. **最终结果**： 哈明窗表达式 (题目表中给出或默写)：
    
    $$w(n) = 0.54 - 0.46 \cos\left(\frac{2\pi n}{N-1}\right) = 0.54 - 0.46 \cos\left(\frac{2\pi n}{32}\right)$$
    
    **最终** $h(n)$ **表达式**：
    
    $$h(n) = \left[ \frac{\sin[0.3\pi (n-16)]}{\pi (n-16)} \right] \cdot \left[ 0.54 - 0.46 \cos\left(\frac{\pi n}{16}\right) \right], \quad 0 \le n \le 32$$

### 案例 2：2023年 第8题 (高通设计)

**题目摘要**： $f_s = 200Hz$, 通带 $f_p = 10Hz$ (注意高通，这里应该是通带边界，通常高通 $f_p > f_{st}$，但题目可能是指通过的频率范围，需根据数值判断。题目原文写：通带截止10Hz，阻带截止30Hz。这看起来像低通？**请注意**：如果是**高通**，阻带频率应低于通带频率。例如阻带0-30Hz衰减，通带>?Hz。 _修正：查看2023原题截图描述_ -> "$f_s=200Hz$, 通带截止频率10Hz, 阻带截止频率30Hz..." **特别注意**：如果题目说“高通”但给出的 $f_{st} > f_p$ (30 > 10)，这在物理上描述的是一个**低通**特性（低频通过，高频阻断）。

- **可能性A**：题目文字有误，实际是低通。
    
- **可能性B**：题目意思是“阻带边缘30Hz，通带边缘10Hz”，即0-10Hz通过，30Hz以上截止 -> 低通。
    
- **可能性C**：题目真的是高通，那么参数应该是“阻带截止30Hz（意味着30Hz以下滤除？不对），通常高通是：阻带截止 $f_{st}$ (比如10Hz)，通带截止 $f_p$ (比如30Hz)。
    
- **结论**：根据2023题干截图“设计第一类FIR**高通**滤波器”，且参数是 $f_p=10, f_{st}=30$，这在逻辑上是冲突的（通常高通要求 $\omega_p > \omega_{st}$）。但如果必须做高通，我们假设参数意指：需要保留的高频成分边界和需要滤除的低频成分边界。
    
    - _假设修正_：我们按标准高通逻辑，假设题目意图是保留高频。但数据 $10$ 和 $30$ 更像低通。
        
    - _考试策略_：如果题目明确写了“高通”，但数据像低通，**务必在答题纸上文字说明**：“根据高通滤波器特性，通带频率应大于阻带频率。若题意为通带边界10Hz，阻带边界30Hz，则实际构成低通特性。以下按题目要求的文字‘高通’进行形式设计，或者按数据特征设计为低通”。
        
    - **此处我们按“高通”的标准模版演示（假设** $\omega_c$ **计算方式不变）**。
        

1. **数字化**： $\omega_1 = \frac{10}{200} \times 2\pi = 0.1\pi$ $\omega_2 = \frac{30}{200} \times 2\pi = 0.3\pi$ $\Delta\omega = 0.2\pi$ $\omega_c = 0.2\pi$
    
2. **定窗**： $A_s \ge 50dB$ -> **哈明窗 (Hamming)**。 $N \approx \frac{6.6\pi}{0.2\pi} = 33$。 $\tau = 16$。
    
3. **理想高通响应**：
    
    $$h_d(n) = \delta(n-16) - \frac{\sin[0.2\pi (n-16)]}{\pi (n-16)}$$
4. **最终结果**：
    
    $$h(n) = h_d(n) \cdot w_{Hamming}(n)$$

## 3. 常见陷阱与注意事项

1. $N$ **的奇偶性**：
    
    - 题目通常要求设计**线性相位**滤波器。
        
    - **Type I (奇数阶，偶对称)**：可用于低通、高通、带通、带阻（万能）。推荐优先选奇数 $N$。
        
    - **Type II (偶数阶，偶对称)**：在 $z=-1$ ($\omega=\pi$) 处必定为0。**不能用于高通**。
        
    - 如果设计**高通**滤波器，算出 $N$ 是偶数（例如32），**必须强制加1** 变为 33 (奇数)，否则无法实现高通特性。
        
2. **单位换算**：
    
    - 一定要看清题目给的是 $Hz$ 还是 $rad/s$ ($\Omega$)。
        
    - $f_s$ (采样频率) 不要漏掉。
        
    - 有些年份（如2022）可能直接给数字频率 $\omega$ (如 $0.1\pi$)，那就省去了第一步，不要画蛇添足再去乘 $T$。
        
3. **画图题 (2022 Q13)**：
    
    - 如果题目要求画“结构框图”，对于FIR滤波器，就是画**横向结构 (Transversal Structure)** / 卷积和结构。
        
    - 即：一串延迟单元 $z^{-1}$，每个节点引出乘法器系数 $h(0), h(1)...$，最后相加。利用线性相位对称性，可以折叠结构（首尾系数相同，先相加再乘系数）以减少乘法器数量。
        
4. **预畸变？**
    
    - **注意**：窗函数法设计FIR**不需要**预畸变。
        
    - 只有“双线性变换法设计IIR滤波器”才需要预畸变。不要混淆！