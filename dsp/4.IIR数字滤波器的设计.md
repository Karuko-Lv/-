1. 数字滤波器（Digital Filter DF）:
	1. 定义：是一种离散时间**系统**，特殊在可以根据需要有选择性的滤除输入信号的某些频率分量，实现对输入信号的处理（模拟滤波器是一种连续时间系统）
	2. 框图：（数字滤波器通常从频域角度对信号特性进行描述，轴是频率）$$x[k] \longrightarrow \boxed{H(e^{j\Omega})} \longrightarrow y[k]$$
	3. 分类
		1. 功能
			1. 低通滤波器
			2. 高通滤波器
			3. 带通滤波器
			4. 带阻滤波器
		2. 单位脉冲响应长度
			1. FIR 滤波器（有限脉冲响应）：系统函数只有零点，无反馈，总是稳定的，易实现线性相位。
			2. IIR 滤波器（无限脉冲响应）：系统函数既有零点又有极点，有反馈，相位非线性，设计利用模拟滤波器原型。
			- **==[考点]== IIR vs FIR**：IIR 利用模拟原型设计，阶数低但相位非线性；FIR 阶数高但可实现严格线性相位。
	4. 指标要求：
		1. 理想低通数字滤波器：只有通带和阻带，且阻带等于 0、通带等于 1。物理上无法实现
		2. 物理上可实现的：![[截屏2025-12-02 23.57.06.png|200]]
			1. 有通带、阻带和过渡带（一定有过渡带）
			2. 通带不可能始终为常数 1，阻带不可能始终为常数 0
		3. 具体指标
			1. $\Omega_p$ : 通带截止频率
			2. $\Omega_s$：阻带截止频率
			3. $\delta_p$：通带波动
			4. $\Omega_p$：阻带波动
			PS：工程应用当中往往将通带阻带波动用衰耗来表示，转换成 dB 值，将通带边界频率处对应的幅度值转换成 dB 值，一般是通带最大衰耗和阻带最小衰耗
			- 通带衰减公式（ dB ）：$A_p=-20lg(1-\delta_p)$ (因为前面说了衰减两个字所以加上了符号 $1-\delta_p<1$, 所以 $A_p >0$)
			- 阻带衰减公式（ dB ）：$A_s=-20lg(\delta_s)$
2. IIR
	1. 设计思路：（模拟的技术成熟）$$\Omega_p, \Omega_s \xrightarrow[\text{变换}]{\text{频率}} \boxed{\omega_p, \omega_s \xrightarrow[\text{滤波器}]{\text{设计模拟}} H(s)} \xrightarrow[\substack{\text{双线性} \\ \text{变换法}}]{\substack{\text{脉冲响应} \\ \text{不变法}}} H(z)$$ $$\omega_p, \omega_s \xrightarrow[\text{变换}]{\text{频率}} \boxed{\bar{\omega}_p, \bar{\omega}_s \xrightarrow[\substack{\text{低通} \\ \text{滤波器}}]{\text{设计原型}} H_L (\bar{s}) }\xrightarrow[\text{变换}]{\text{复频率}} H (s)$$ 有 BW、CB、C 三个低通滤波器模版，模拟低通滤波器是设计核心
		 - **间接法**：
			 - 数字滤波器
		         1. 将数字滤波器指标 ($\Omega$) 转换为模拟滤波器指标 ($\omega$)。
		         2. 设计模拟滤波器 $H(s)$。
		         3. 将任意滤波器转换成数字滤波器，将 $H(s)$ 映射为数字滤波器 $H(z)$。
			- 模拟滤波器
				1. 将任意模拟滤波器指标($\omega$) 转换成低通的模拟滤波器指标（$\bar{\omega}$）
				2. 设计低通模拟滤波器 $H_L (\bar{s})$ 
				3. 将低通滤波器转换成任意模拟滤波器，即将 $H_L (\bar{s})$ 映射为数字滤波器 $H(s)$。
		- **指标定义**：通带截频 $\Omega_p$，阻带截频 $\Omega_s$，通带最大衰减 $A_p$ (dB)，阻带最小衰减 $A_s$ (dB)。
3. 模拟低通滤波器设计 (原型设计)


---

# IIR 数字滤波器设计核心笔记

---

## 2. 模拟低通滤波器设计 (原型设计)

这一步是所有设计的基石，后续的高通、带通、带阻都以此为基础。

### 2.1 Butterworth (巴特沃斯) 滤波器 (BW型)

1. **频域特性**：
    
    - **最大平坦性**：通带内幅频响应最平滑，单调下降，无波纹。
        
    - **==[考点]== 3dB 截频**：$\omega_c$ 处衰减约为 3dB。
        
    - 幅度模方：$|H(j\omega)|^2 = \frac{1}{1+(\omega/\omega_c)^{2N}}$。
        
2. **设计步骤**：
    
    - 确定阶数 $N$：根据 $A_p, A_s$ 计算。
        
    - 确定截止频率 $\omega_c$：通常取通带和阻带计算出的交集范围。
        
3. **极点分布**：均匀分布在 $s$ 平面左半平面的圆上，间隔 $\pi/N$。
    

### 2.2 Chebyshev (切比雪夫) 滤波器 (CB型)

1. **Chebyshev I 型 (CBI)**：
    
    - **==[考点]==**：通带**等波纹**，阻带单调下降。
        
    - 全极点系统。
        
2. **Chebyshev II 型 (CBII)**：
    
    - **==[考点]==**：通带单调下降，阻带**等波纹**。
        
    - 既有极点也有零点。
        
3. **特性对比**：相同指标下，Chebyshev 阶数比 Butterworth 低，但在通带/阻带会有波动。
    

### 2.3 椭圆 (Elliptic) 滤波器

1. **特性**：
    
    - 通带和阻带**均为等波纹**。
        
    - **==[考点]== 阶数最低**：在相同指标下，椭圆滤波器的阶数 $N$ 最小，过渡带最窄。
        
    - **==[小众点]==**：实现最困难，且极点离虚轴最近，对参数灵敏度高。
        

### 2.4 三种滤波器总结对比 (重要考点)

|**特性**|**Butterworth**|**Chebyshev I**|**椭圆 (Elliptic)**|
|---|---|---|---|
|**通带特性**|最平坦 (单调)|等波纹|等波纹|
|**阻带特性**|单调下降|单调下降|等波纹|
|**过渡带**|最宽 (下降慢)|较窄|最窄 (最陡峭)|
|**阶数 N**|最高|中等|最低|
|**相位线性**|相对最好|较差|最差|

---

## 3. 模拟域频率变换 (非低通设计)

设计高通、带通、带阻时，先设计**归一化原型低通滤波器** ($H_L(\bar{s})$，$\bar{\omega}_p=1$)，再变换。

1. **低通 $\to$ 高通 (LP $\to$ HP)**
    
    - 变换公式：$\bar{s} = \frac{1}{s}$ 或 $\bar{\omega} = -1/\omega$。
        
    - **==[考点]==**：将低通的原点映射到高通的无穷远处。
        
2. **低通 $\to$ 带通 (LP $\to$ BP)**
    
    - 变换公式：$\bar{s} = \frac{s^2 + \omega_0^2}{Bs}$。
        
    - 参数：$B$ (带宽)，$\omega_0$ (中心频率 $\sqrt{\omega_{p1}\omega_{p2}}$)。
        
    - **==[考点/难点]==**：由于模拟带通往往不对称，映射到原型低通时，阻带截频 $\bar{\omega}_s$ 需取 $\min(|\bar{\omega}_{s1}|, |\bar{\omega}_{s2}|)$ 以保证严谨满足指标。
        
    - 阶数变化：带通滤波器阶数是原型低通的 **2倍**。
        
3. **低通 $\to$ 带阻 (LP $\to$ BS)**
    
    - 变换公式：$\bar{s} = \frac{Bs}{s^2 + \omega_0^2}$。
        
    - **==[考点/难点]==**：映射到原型低通时，阻带截频 $\bar{\omega}_p$ 需取 $\max(|\bar{\omega}_{p1}|, |\bar{\omega}_{p2}|)$。
        

---

## 4. 模拟 $\to$ 数字滤波器转换方法 (核心考点)

### 4.1 脉冲响应不变法 (Impulse Invariance Method)

1. **原理**：时域逼近。使数字滤波器的单位脉冲响应 $h[k]$ 等于模拟滤波器响应的采样 $h(kT)$。
    
2. **映射关系**：$z = e^{sT}$。
    
    - $s$ 平面左半平面 $\to$ $z$ 平面单位圆内。
        
    - 线性频率关系：$\omega = \Omega / T$。
        
3. **缺点 (致命弱点)**：
    
    - **==[考点]== 频谱混叠 (Aliasing)**：模拟滤波器的频响不是带限的，采样后高频部分会折叠到低频。
        
    - **适用性**：仅适用于**低通**和**带通**。
        
    - **==[考点]==**：绝对**不能**用于设计高通和带阻滤波器 (因为高频部分不衰减，混叠严重)。
        
4. **==[小众点]== 增益修正**：通常需要乘以 $T$，以消除采样带来的幅度 $1/T$ 缩放，即 $H(z) \approx T \cdot H(s)$。
    

### 4.2 双线性变换法 (Bilinear Transformation Method)

1. **原理**：通过非线性频率压缩，将整个 $j\omega$ 轴压缩到单位圆上，避免混叠。
    
2. **映射关系**：$s = \frac{2}{T} \frac{1-z^{-1}}{1+z^{-1}}$。
    
3. **频率预畸变 (Pre-warping) ==[核心考点]==**：
    
    - 模拟频率 $\omega$ 与数字频率 $\Omega$ 是非线性正切关系。
        
    - 公式：$\omega = \frac{2}{T} \tan(\frac{\Omega}{2})$。
        
    - **设计步骤**：先将数字指标 $\Omega$ 用上述公式“预畸变”为模拟指标 $\omega$，设计模拟滤波器，最后代入变换公式。
        
4. **优缺点**：
    
    - 优点：无混叠，适用于所有类型 (LP, HP, BP, BS)。
        
    - 缺点：频率轴是非线性的，高频部分压缩严重 (但在分段常数的滤波器设计中影响不大)。
        

---

## 5. MATLAB 设计与实现

1. **常用函数**：
    
    - `buttord` / `butter`：巴特沃斯设计。
        
    - `cheb1ord` / `cheby1`：切比雪夫 I 型。
        
    - `ellipord` / `ellip`：椭圆滤波器。
        
2. **转换函数**：
    
    - `impinvar(num, den, Fs)`：脉冲响应不变法。
        
    - `bilinear(num, den, Fs)`：双线性变换法。
        
3. **模拟域变换函数**：
    
    - `lp2hp`, `lp2bp`, `lp2bs`：将模拟低通原型转换为其他类型。
        
4. **==[小众点]== 注意事项**：MATLAB 中的 `butter` 等函数若不加参数 `'s'`，默认设计的是数字滤波器 (即内部自动包含了双线性变换步骤)；加上 `'s'` 才是设计模拟滤波器。
    

---

## 6. 应用实例：脉搏信号处理

1. **信号特征**：
    
    - 有效频率：1Hz ~ 20Hz。
        
    - 主要噪声：
        
        - 基线漂移 (0 ~ 1Hz)。
            
        - 工频干扰 (50Hz)。
            
        - 高频肌电干扰 (>20Hz)。
            
2. **滤波方案**：
    
    - **方案一**：设计一个通带为 [1Hz, 20Hz] 的带通滤波器。
        
    - **方案二 (级联)**：设计一个截止频率 1Hz 的高通 (去基线漂移) + 一个截止频率 20Hz 的低通 (去高频)。
        
    - **对比**：方案二级联方式调试更灵活；BW 型相位较好，CB 型阶数更低但波形可能有失真。
        

---

## 7. 考前速记表

|**比较项目**|**脉冲响应不变法**|**双线性变换法**|
|---|---|---|
|**频率映射**|线性 $\omega = \Omega/T$|非线性 $\omega = \frac{2}{T}\tan(\frac{\Omega}{2})$|
|**频谱混叠**|**有** (严重缺陷)|**无** (主要优势)|
|**适用范围**|仅限带限信号 (低通/带通)|所有类型 (低/高/带通/带阻)|
|**s 平面映射**|多条带状区域映射到单位圆内|整个左半平面单值映射到单位圆内|
|**设计核心**|保持 $h(t)$ 采样值不变|保持代数转换关系|
