$$H_d(e^{j\Omega}) = A_d(\Omega) \cdot e^{-j\Omega \frac{M}{2}}$$ 和 $$H_d(e^{j\Omega}) = A_d(\Omega) \cdot e^{-j\Omega \frac{M}{2}+\frac{\pi}{2}}$$ 这两个公式的区别揭示了 **FIR 滤波器的两种截然不同的物理性质**。

简单来说：

1. **第一个公式**对应的是 **对称** 的脉冲响应（Type I, II），用于做普通的**选频滤波器**（如低通、高通）。
    
2. **第二个公式**对应的是 **反对称** 的脉冲响应（Type III, IV），用于做**微分器**或**希尔伯特变换器**。
    

核心在于那个额外的相移 **$\frac{\pi}{2}$**。

---

### 1. 第一种形式：标准对称型 (Type I & II)

$$H_d(e^{j\Omega}) = A_d(\Omega) \cdot e^{-j\Omega \frac{M}{2}}$$

- 物理含义：
    
    这里的相位只有 $- \Omega \frac{M}{2}$，这是一个纯粹的线性相位，只代表时间延迟。
    
    这意味着：输入信号里的所有频率成分，仅仅是“晚了一点”出来，波形形状没有发生扭曲。
    
- 时域特征：
    
    对应的单位脉冲响应 $h[n]$ 是 偶对称 (Even Symmetric) 的：
    
    $$h[n] = h[M-n]$$
    
    - **直观想象：** 以中心为轴，左右两边长得一模一样（像镜子）。
        
- 典型应用：
    
    我们最常用的 低通、高通、带通、带阻 滤波器，全都是用这个公式设计的。因为我们需要保真，只改变幅度，不改变相位的相对关系。
    

---

### 2. 第二种形式：反对称型 (Type III & IV)

$$H_d(e^{j\Omega}) = A_d(\Omega) \cdot e^{-j\Omega \frac{M}{2} + j\frac{\pi}{2}}$$

（注：有时写成 $- \frac{\pi}{2}$，本质一样，只是方向不同）

- 物理含义：
    
    这里多了一个常数项相移 $\frac{\pi}{2}$ (即 $90^\circ$)。
    
    利用欧拉公式，$e^{j\frac{\pi}{2}} = j$。所以这个公式其实是：
    
    $$H_d(e^{j\Omega}) = j \cdot A_d(\Omega) \cdot e^{-j\Omega \frac{M}{2}}$$
    
    这意味着滤波器对通过的所有频率成分，不仅做了延迟，还统统把相位旋转了 90度。
    
- 时域特征：
    
    对应的单位脉冲响应 $h[n]$ 是 奇对称 / 反对称 (Odd Symmetric) 的：
    
    $$h[n] = -h[M-n]$$
    
    - **中心点强制为0：** 如果是 Type III（$M$ 为偶数），中心点必须是 0，因为 $h[M/2] = -h[M/2] \Rightarrow 0$。
        
    - **直观想象：** 以中心为轴，左边是右边的“倒影”（一正一负）。
        
- 典型应用：
    
    这种滤波器不能用来做普通的低通（因为它把直流分量 $\Omega=0$ 抹杀掉了，因为 $\sin(0)=0$）。它主要用于特殊数学运算：
    
    1. **数字微分器 (Differentiator)：** 模拟求导运算。
        
    2. **希尔伯特变换器 (Hilbert Transformer)：** 专门用于产生 $90^\circ$ 相移。
        

---

### 3. 为什么加了 $\pi/2$ 就变反对称了？

这源于傅里叶变换的一个基本性质：

- **实偶对称**序列 $\leftrightarrow$ 傅里叶变换是 **纯实数** (Real)。
    
    - 对应公式 1（忽略线性相位延时因子后，剩下的是实数 $A_d$）。
        
- **实奇对称**序列 $\leftrightarrow$ 傅里叶变换是 **纯虚数** (Imaginary)。
    
    - 对应公式 2。因为 $e^{j\pi/2} = j$，所以 $H_d$ 变成了纯虚数。
        

### 总结对照表

|**特征**|**公式 1 (无 π/2)**|**公式 2 (有 π/2)**|
|---|---|---|
|**数学项**|$e^{-j\Omega \frac{M}{2}}$|$e^{-j\Omega \frac{M}{2}} \cdot j$|
|**时域对称性**|**偶对称** ($h[n] = h[M-n]$)|**奇对称** ($h[n] = -h[M-n]$)|
|**FIR 类型**|Type I, Type II|Type III, Type IV|
|**中心点值**|可以是非零值|往往是 0 (Type III)|
|**功能**|**选频** (低通/高通/带通)|**运算** (微分器/90度移相)|
|**直流特性**|允许直流通过 (如低通)|**必杀直流** (在 $\omega=0$ 处必定为0)|

针对**理想低通滤波器**在 **I 型（Type I）** 和 **II 型（Type II）** 设计时的具体表达式，其实核心区别就在于那个**线性相位延时量 $\tau$** 的取值不同。

为了让你在代码或计算中直接能用，我把这两者的公式拆解如下：

### 1. 核心公式（通用版）

无论是 I 型还是 II 型，我们设计的出发点都是对理想 Sinc 函数进行延时。

$$h_d[k] = \frac{\sin[\omega_c (k - \tau)]}{\pi (k - \tau)}$$

- **$k$**：采样点序号 ($0, 1, \dots, N-1$)
    
- **$\omega_c$**：截止频率
    
- **$\tau$**：中心延时量，$\tau = \frac{N-1}{2}$
    

---

### 2. I 型理想低通 (Type I)

- **条件**：滤波器长度 $N$ 为 **奇数**。
    
- **延时 $\tau$**：是一个 **整数** (Integer)。
    
    - 例如：$N=31$，$\tau = 15$。
        
- **特点**：
    
    - 对称中心**正好落在**中间那个采样点上。
        
    - 在中心点 $k = \tau$ 处，分母为 0，利用洛必达法则取极限，值为 $\frac{\omega_c}{\pi}$。
        
- 公式写法：【背✅】
    
    ~={red} $$h_d[k] = \begin{cases} \frac{\sin[\omega_c (k - \tau)]}{\pi (k - \tau)}, & k \ne \tau \\ \frac{\omega_c}{\pi}, & k = \tau \end{cases}$$ =~
    

---

### 3. II 型理想低通 (Type II)

- **条件**：滤波器长度 $N$ 为 **偶数**。
    
- **延时 $\tau$**：是一个 **半整数** (Half-integer)。
    
    - 例如：$N=32$，$\tau = 15.5$。
        
- **特点**：
    
    - 对称中心落在两个采样点**之间**（例如 15 和 16 之间）。
        
    - **永远不会出现分母为 0 的情况**。因为 $k$ 是整数，$\tau$ 是半整数，$k-\tau$ 永远不等于 0。
        
    - 采样点是“跨”着峰值对称分布的，没有单一的最高点。
        
- 公式写法（不需要分段讨论）：
    
    $$h_d[k] = \frac{\sin[\omega_c (k - \tau)]}{\pi (k - \tau)}$$
    

---

### 4. 总结对比图表

|**特性**|**I 型 (Type I)**|**II 型 (Type II)**|
|---|---|---|
|**长度 $N$**|奇数 (Odd)|偶数 (Even)|
|**延时 $\tau$**|整数 (Integer)|半整数 (Half-integer, x.5)|
|**对称中心**|在采样点上|在两点中间|
|**中心点值**|需要单独处理 ($\frac{\omega_c}{\pi}$)|直接代入公式计算|
|**物理形态**|有一个最高的“尖峰”采样点|两个一样高的点夹着中心|
|**适用场景**|通用，最推荐|仅限低通，且不介意半整数延时|

最关键的注意点：

如果你是在写代码（如 MATLAB/Python），对于 I 型，一定要写个 if 判断处理分母为 0 的情况；对于 II 型，则可以直接一行代码算到底。


---

这是一个非常关键的转折点。

如果说 **I 型和 II 型** 是为了“**保持波形**”（只延时，不改形状，偶对称），那么 **III 型和 IV 型** 就是为了“**扭转波形**”（产生 90 度相移，奇对称/反对称）。

最核心的区别在于：**III 型和 IV 型绝对不能用来设计低通滤波器**（除非你想要一个把直流信号 $0\text{Hz}$ 彻底杀死的奇怪低通）。

以下是 III 型和 IV 型的详细拆解，格式与之前保持一致：

### 0. 核心区别：反对称 (Antisymmetry)

I/II 型是左右像照镜子（$h[n] = h[N-1-n]$）。

III/IV 型是左右像倒影，一正一负（$h[n] = -h[N-1-n]$）。

这种反对称性导致了一个致命的频谱特性：**在直流频率 ($\omega=0$) 处，幅度必须为 0。**

- 这就是为什么它们不能做低通（低通要求直流通过，幅度为 1）。
    
- 它们通常用于 **希尔伯特变换器** (90度移相) 或 **微分器**。
    

---

### 1. III 型 (Type III)

- **条件**：滤波器长度 $N$ 为 **奇数**。
    
- **延时 $\tau$**：是一个 **整数** ($\tau = \frac{N-1}{2}$)。
    
- **“必死”的频率点**：
    
    1. **直流 ($\omega=0$) 必为 0**：由反对称性决定。
        
    2. **奈奎斯特 ($\omega=\pi$) 必为 0**：由 $N$ 为奇数且反对称决定。
        
- 中心点特征：
    
    由于 $h[\tau] = -h[\tau]$，唯一的解是 $h[\tau] = 0$。
    
    也就是中间那个采样点必须强制设为 0。
    
- 理想公式（以希尔伯特变换为例）：【背✅】
    
    不再是 Sinc 函数，而是类似这样的形式：
    
    ~={red} $$h_d[k] = \begin{cases} \frac{1 - \cos[\pi (k-\tau)]}{\pi (k-\tau)}, & k \ne \tau \\ 0, & k = \tau \end{cases}$$ =~
    
    (注意：分子变成了 $1-\cos$，这就是为了制造反对称)
    

---

### 2. IV 型 (Type IV)

- **条件**：滤波器长度 $N$ 为 **偶数**。
    
- **延时 $\tau$**：是一个 **半整数**。
    
- **“必死”的频率点**：
    
    1. **直流 ($\omega=0$) 必为 0**：由反对称性决定。
        
    2. **奈奎斯特 ($\omega=\pi$)**：**不受限制！** 可以不为 0。
        
- 中心点特征：
    
    对称中心在两点之间，没有中心采样点，所以不需要强制中间为 0。
    
- 优势：
    
    因为 $\omega=\pi$ 处可以有值，所以 Type IV 非常适合设计 数字微分器 或 宽带希尔伯特变换器（高频性能比 Type III 好，因为 Type III 在高频被迫归零了）。
    
- 理想公式：
    
    $$h_d[k] = \frac{1 - \cos[\pi (k-\tau)]}{\pi (k-\tau)}$$
    

---

### 3. 四种类型全景总结图表

|**特性**|**I 型**|**II 型**|**III 型**|**IV 型**|
|---|---|---|---|---|
|**对称性**|**偶对称** (即便)|**偶对称** (即便)|**奇对称** (奇负)|**奇对称** (奇负)|
|**长度 $N$**|**奇数**|**偶数**|**奇数**|**偶数**|
|**延时 $\tau$**|整数|半整数|整数|半整数|
|**中心点值**|可任意|无中心点|**强制为 0**|无中心点|
|**直流 $\omega=0$**|可通过|可通过|**强制为 0**|**强制为 0**|
|**高频 $\omega=\pi$**|可通过|**强制为 0**|**强制为 0**|可通过|
|**核心用途**|**低通 (首选)**、高通、带通|低通 (备选)|带通 (很少用)|**微分器、希尔伯特**|

### 4. 你的“避坑”指南

如果你在做设计：

1. **要做低通/高通？** $\rightarrow$ **盯着 I 型** 就行了。
    
2. **要做 90 度移相 (希尔伯特)？** $\rightarrow$ **选 IV 型** (因为它高频好)。
    
3. **什么时候会不小心用到 III 型？** $\rightarrow$ 当你想做移相器，但通过计算公式算出 $N$ 是奇数时。这时候你会发现高频 ($\pi$) 处信号莫名其妙没了。解决办法是：**强行把 $N$ 加 1 变成偶数，转为 IV 型**。
    

**一句话口诀：**

- **一三奇，二四偶**（指长度 $N$）。
    
- **一二保形，三四变形**（指对称性）。
    
- **三四杀直流，二三杀高频。**