0. 先置知识
	1. 阶数

| **滤波器类型** | **系统函数形式**                               | **滤波器阶数**              | **z 的最高负幂次**    |
| --------- | ---------------------------------------- | ---------------------- | --------------- |
| **FIR**   | $H(z)=\sum_{k=0}^{M}h[k]z^{-k}$          | $M$                    | $M$             |
| **IIR**   | $H(z)=\frac{\text{分子}(M)}{\text{分母}(N)}$ | 通常为 $N$ 或 $\max(M, N)$ | 分子为 $M$，分母为 $N$ |
1. FIR 数字滤波器定义: 
	1. （引入）一般离散 LTI 系统的系统函数通式：$$H(z)=\frac{\sum_{j=0}^{M}b_{j}z^{-j}}{1+\sum_{j=1}^{N}a_{i}z^{-i}}$$
		- 若分母项 $a_i = 0$，则 ~={red} $$H(z)=\sum_{j=0}^{M}b_{j}z^{-j} \iff h[k]=\mathbb{Z}^{-1}\{H(z)\}=\{b_{0},b_{1},\cdots,b_{M}\}$$ =~ $h[k]$ 长度有限，只有 $M+1$ 项==> $M$ 为滤波器阶数，$N = M+1$ 为单位脉冲响应 $h[k]$ 的长度
	2. **FIR 滤波器定义**: 系统的单位脉冲响应 $h[k]$ 仅在有限范围内有非零值
	     - $M$ 阶 FIR 滤波器的系统函数为: $H(z)=\sum_{k=0}^{M}h[k]z^{-k}$ 
	     - **$h[k]$ 的长度 $N$**：$N=M+1$  （$h[k]$是$h[0]$到$h[N-1]$）
	3. FIR🆚IIR ：
		1. IIR：$H(z)=\frac{\sum_{j=0}^{M}b_{j}z^{-j}}{1+\sum_{j=1}^{N}a_{i}z^{-i}}$
			1. 存在极点，所以**系统有可能不稳定**。For因果系统如果极点最大的模在单位圆外则系统不稳定
			2. 系统一定是非线性相位的
		2. FIR：$H(z)=\sum_{j=0}^{M}b_{j}z^{-j}$
			1. 系统一定是稳定的，只有一个极点 $z=0$ 一定在单位圆内（🧚‍♀️我的书上写的 N-1 阶重极点）
			2. 系统可以设计成具有**线性相位** ⚠️不是说 FIR 一定都是线性相位的
2. **FIR 滤波器特点**：
    - **稳定性（考点）**: $M$ 个极点都位于 $z=0$，单位脉冲响应是有限长的，系统**一定稳定** 4。
    - **相位特性（考点）**: 很容易设计成具有**线性相位**，这是其最显著的特点 5。
    - **实现**: 任何非因果的 FIR 系统经过延时都可变成因果 FIR 系统，总能用因果系统实现 6。
    - **阶数**: 实现相同指标，所需阶数通常**较高** (与 IIR 相比)。
    - **幅度响应**: 相较于 IIR 滤波器，幅度响应设计**较难** (不好)。
    - **适用场景**: 适合处理对相位要求较高的信号，如图像信号。
3. **线性相位条件（核心考点）**：
	1. 定义：若一个信号是含有 2 个单频分量的正弦信号，每个分量延时一样，则该系统是线性相位系统，整体延时也一样，波形不变；如果对不同频率延时不一样，整体信号的波形就发生了失真，波形是不一样的-->相位失真导致信号波形改变
	2. 分类：
		1. 严格线性相位系统：系统的频率响应可以表示为幅度函数和相位函数
			1. 频率响应：$H(\mathrm{e}^{\mathrm{j}\Omega})=\left|H(\mathrm{e}^{\mathrm{j}\Omega})\right|\mathrm{e}^{\mathrm{j}\varphi(\Omega)}$
			2. 幅度函数：$\left|H(\mathrm{e}^{\mathrm{j}\Omega})\right|$ 一定是正的，一定是实函数，$|H(e^{j\Omega})| = \sqrt{(\operatorname{Re}\{H(e^{j\Omega})\})^2 + (\operatorname{Im}\{H(e^{j\Omega})\})^2}$
			3. 相位函数： $\varphi(\Omega)=-a\Omega$ 满足该相位特性的系统称之为严格的线性相位系统
		2. 广义线性相位系统：系统的频率响应 $H(e^{j\Omega})$ 可表示为：$$H(e^{j\Omega})=A(\Omega)e^{j(-\alpha\Omega+\beta)}$$ 其中 $\alpha$ 和 $\beta$ 是与 $\Omega$ 无关的常数，$A(\Omega)$ 是可正可负的实函数（幅值响应）。
			- FIR 滤波器具有线性相位指的是广义线性相位
			- 相位函数：~={red} $\varphi(\Omega)=-\alpha\Omega+\beta$ =~
			~={purple}PS： $\alpha>0$ 因为一般系统是有延时的=~
	3. 公式： $\begin{aligned}&y(t)=kx(t-t_{0})\\&y(jw)=kz(jw)e^{-jwt_{0}}\\&H(jw)=ke^{-jwt_{0}}，若k>0,则\varphi(jw)=-wt_{0}\\&\tau = -\frac{d\varphi(jw)}{jw}=t_0\end{aligned}$ ==>具有 $\varphi(jw)=-wt_{0}$ 相位特性的系统称之为线性相位
	4. 特点 :对信号当中所有的频率分量延时是同一个常数，同一个值==>🧚‍♀️群延时为常数
	5. **线性相位的~={red}充要条件=~（考点）**:（相互关联，验证其一即可） 时域对称和 $z$ 域对称
		1. **时域条件**: $h[k]=\pm h[M-k]$
		2. **$z$ 域条件**: $H(z)=\pm z^{-M}H(z^{-1})$
4. FIT幅频特性：1 为中心波动
![[Pasted image 20251204150528.png|300]]
5. FIR 数字滤波器的设计
	1. 给定的设计指标确定数字滤波器**系统函数** $H (z)$
	2. 【特殊点】IIR 最后的设计目标一定给用户给的是 $H(z)$；FIR 可以给 $H(z)$ 或者 $h[k]$, 因为 $h[k]$ 是有限项 $H(z)=\sum_{k=0}^{M}h[k]z^{-k}$ 
6. **线性相位 FIR 滤波器的四种类型（核心考点）**：根据线性相位系统的单位脉冲响应 $h[k]$ 的对称性（偶对称/奇对称）和滤波器阶数 $M$ 的奇偶性，线性相位 FIR 滤波器分为四种类型
	1. **I 型线性相位系统**![[截屏2025-12-04 15.52.53.png|150]]
		1. 时域特性：
			1. $h[k]$ 偶对称：$h[k]=h[M-k]$
			2. 阶数：偶数 
		2. 频域特性：
	2. **II型线性相位系统**![[截屏2025-12-04 15.54.21.png|150]]
		1. 时域特性：
			1. $h[k]$ 偶对称：$h[k]=h[M-k]$
			2. 阶数：奇数 
		2. 频域特性：
	3. **III 型线性相位系统**![[截屏2025-12-04 15.56.12.png|150]]
		1. 时域特性
			1. $h[k]$ 奇对称：$h[k]=-h[M-k]$
			2. 阶数：偶数
			⚠️III 型序列有一个点必为 0
		2. 频域特性
	4. **IV 型线性相位系统**![[截屏2025-12-04 15.57.26.png|150]]
		1. $h[k]$ 奇对称：$h[k]=-h[M-k]$
		2. 阶数：奇数 

## FIR 数字滤波器设计笔记

### 1. 线性相位 FIR 滤波器的特性

| **类型**  | **阶数 M** | **h[k] 对称性**         | **α**  | **β**   | **幅度响应 A(Ω) 形式**                                                | **A(π)** | **A(0)** | **不适用滤波器类型 (小众点)**      |
| ------- | -------- | -------------------- | ------ | ------- | --------------------------------------------------------------- | -------- | -------- | ----------------------- |
| **I**   | 偶数       | 偶对称 $(h[k]=h[M-k])$  | $0.5M$ | $0$     | $A(\Omega)=\sum_{n=0}^{M/2}a[n]\cos(n\Omega)$                   | 任意       | 任意       | 无 (LP, HP, BP, BS 均可)   |
| **II**  | 奇数       | 偶对称 $(h[k]=h[M-k])$  | $0.5M$ | $0$     | $A(\Omega)=\sum_{n=0}^{(M-1)/2}b[n]\cos([n+\frac{1}{2}]\Omega)$ | $0$      | 任意       | HP, BS (高通, 带阻)         |
| **III** | 偶数       | 奇对称 $(h[k]=-h[M-k])$ | $0.5M$ | $\pi/2$ | $A(\Omega)=\sum_{n=0}^{M/2}c[n]\sin(n\Omega)$                   | $0$      | $0$      | LP, HP, BS (低通, 高通, 带阻) |
| **IV**  | 奇数       | 奇对称 $(h[k]=-h[M-k])$ | $0.5M$ | $\pi/2$ | $A(\Omega)=\sum_{n=0}^{(M-1)/2}d[n]\sin([n+\frac{1}{2}]\Omega)$ | 任意       | $0$      | LP (低通)                 |

**幅度函数 $A(\Omega)$ 的性质**11:

|**类型**|**A(Ω) 关于 Ω=0 的对称性**|**A(Ω) 关于 Ω=π 的对称性**|**A(Ω) 周期 (小众点)**|
|---|---|---|---|
|**I**|偶对称|偶对称|$2\pi$|
|**II**|偶对称|奇对称|$4\pi$|
|**III**|奇对称|奇对称|$2\pi$|
|**IV**|奇对称|偶对称|$4\pi$|

**公式速记（考点）**
- **偶对称** $h[k]=h[M-k]$：$\beta=0$ (I, II 型)。
- **奇对称** $h[k]=-h[M-k]$：$\beta=\pi/2$ (III, IV 型)。
- **$A(\Omega)$ 形式**：偶对称含 $\cos$ 项，奇对称含 $\sin$ 项。
- **$A(0)=0$**：III 型和 IV 型（奇对称，$\sin(0)=0$） 12。
- **$A(\pi)=0$**：II 型和 III 型（利用 $A(\Omega)$ 关于 $\Omega=\pi$ 的奇对称性） 13。
#### 1.4 线性相位系统的零点分布（小众点）

1. **零点对称性**：若 $z_i$ 是 $H(z)$ 的零点，则其**倒数** $z_i^{-1}$ 也是零点 14。由于 $h[k]$ 为实序列，**共轭** $z_i^*$ 也是零点 15。
    
2. **四种零点组合模式** 16161616161616：
    
    - **非单位圆上的复零点** $z_i=re^{j\theta}$：四重组合 $\{z_i, z_i^*, z_i^{-1}, (z_i^{-1})^*\}$。构成四阶偶对称因子 $H_1(z)=1+az^{-1}+bz^{-2}+az^{-3}+z^{-4}$。
        
    - **单位圆上的复零点** $z_i=e^{j\theta}$：二重组合 $\{z_i, z_i^*\}$。构成二阶偶对称因子 $H_3(z)=1+az^{-1}+z^{-2}$。
        
    - **非单位圆上的实零点** $z_i=r$：二重组合 $\{z_i, z_i^{-1}\}$。构成二阶偶对称因子 $H_2(z)=1+az^{-1}+z^{-2}$。
        
    - **单位圆上的实零点** $z_i=\pm 1$：单独出现。
        
        - $z_i=1$: 因子 $1-z^{-1}$ (奇对称) 17。
            
        - $z_i=-1$: 因子 $1+z^{-1}$ (偶对称) 18。
            
3. **零点与滤波器类型的关系（小众点）**19191919:
    
    - **III 型**：在 $z=1$ 和 $z=-1$ 都有**奇数个**零点 20。
        
    - **IV 型**：在 $z=1$ 有**奇数个**零点，在 $z=-1$ 无零点或有偶数个零点 21。
        
    - **II 型**：在 $z=-1$ 有**奇数个**零点，在 $z=1$ 无零点或有偶数个零点 22。
        
    - **I 型**：在 $z=1$ 和 $z=-1$ 无零点或有偶数个零点 23。
        

### 2. 窗函数法设计

#### 2.1 设计思想与步骤（核心考点）

1. **基本思想（考点）**：在时域逼近理想滤波器的单位脉冲响应 $h_d[k]$ 24。
    
    - $H(e^{j\Omega}) = \frac{1}{2\pi}H_d(e^{j\Omega}) * W_N(e^{j\Omega})$ (频域的圆周卷积) 25。
        
2. **设计步骤（考点）**26:
    
    - 1. 由 $H_{d}(e^{j\Omega})$ 确定 FIRDF 的**类型**和幅度函数 $A_{d}(\Omega)$ 27。
        
    - 2. 根据类型确定理想滤波器的相位 $\varphi_{d}(\Omega)$28:
        
        $$\varphi_{d}(\Omega)=-0.5M\Omega+\beta \quad (\beta=0\text{ 或 }\pi/2)$$
        
        29
        
    - 3. 根据 $A_{d}(\Omega)$ 和 $\varphi_{d}(\Omega)$ 通过 IDTFT 求解无限长非因果序列 $h_{d}[k]$30:
        
        $$h_{d}[k]=\frac{1}{2\pi}\int_{-\pi}^{\pi}A_{d}(\Omega)e^{j\varphi_{d}(\Omega)}e^{jk\Omega}d\Omega$$
        
        31
        
    - 4. 加窗截短 $h_{d}[k]$，得到有限长因果序列 $h[k]$32:
        
        $$h[k]=h_{d}[k]w_{N}[k]$$
        
        33
        

#### 2.2 矩形窗与吉伯斯（Gibbs）现象（核心考点）

1. 矩形窗定义34:
    
    $$w_{N}[k]=\begin{cases}1&0\le k\le M\\ 0&\text{其他}\end{cases}$$
    
2. **矩形窗频谱 $|W_N(\Omega)|$ 特性（考点）**35:
    
    - **主瓣宽度**: $4\pi/N$ 36。
        
    - **旁瓣**: 旁瓣相对衰减为**常数** (不随 $N$ 增大而减小)。
        
3. **吉伯斯 (Gibbs) 现象（核心考点）**37373737:
    
    - **现象**: 由于对理想滤波器的单位脉冲响应 $h_{d}[k]$ **截短**而引起的，所设计的滤波器在通带和阻带都会在截止频率附近出现**振荡**（过冲）现象 38383838。
        
    - **特点**:
        
        - 最大波纹（波动幅度 $\delta_p=\delta_s$）与滤波器阶数 $M$ **无关**，约为幅度跳变值的 **9%** ($\delta_p \approx 0.09$) 393939。
            
        - 对应的阻带最小衰减 $A_s$ 约为 **$21 \text{ dB}$** ($A_{s}=-20\lg\delta_s \approx -20\lg(0.09) \approx 20.9 \text{ dB}$) 40404040。
            
        - 滤波器阶数 $M$ 增加，振荡的波纹数量增加，宽度减小，但**幅度不变** 41。
            
    - **过渡带宽度（小众点）**: 矩形窗的近似过渡带宽度为 $1.8\pi/N$ 42。
        

#### 2.3 常用加权窗与可调窗（核心考点）

为减小旁瓣，提高阻带衰减，常使用加权窗。减小旁瓣的代价是增加主瓣宽度，从而增加过渡带宽度 43。

|**窗的类型**|**As​ (dB) (近似)**|**δp​, δs​ (近似)**|**主瓣宽度**|**近似过渡带宽度**|**特点/备注**|
|---|---|---|---|---|---|
|**矩形**|$21 \text{ dB}$ 44|$0.09$ 45|$4\pi/N$ 46|$1.8\pi/N$ 47|旁瓣衰减最小，过渡带最窄 48。|
|**Hann**|$44 \text{ dB}$ 49|$0.0064$ 50|$8\pi/N$ 51|$6.2\pi/N$ 52|阻带衰减比矩形窗提高约 $23 \text{ dB}$ 53。|
|**Hamming**|$53 \text{ dB}$ 54|$0.0022$ 55|$8\pi/N$ 56|$7.0\pi/N$ 57|-|
|**Blackman**|$74 \text{ dB}$ 58|$0.0002$ 59|$12\pi/N$ 60|$11.4\pi/N$ 61|旁瓣衰减最大，过渡带最宽 62。|
|**Kaiser**|**可调**|**可调**|**可调**|**可调**|可调窗，通过参数 $\beta$ 控制旁瓣大小和过渡带宽度 63。|

**Kaiser 窗公式（小众点/公式考点）** 6464646464

1. 窗函数定义 ($N=M+1$)：
    
    $$w[k]=\frac{I_{0}(\beta\sqrt{1-(1-2k/M)^{2}})}{I_{0}(\beta)}, \quad 0\le k\le M$$
    
    65其中 $I_0(x)$ 是零阶第一类修正贝塞尔函数 66。
    
2. 参数 $A$ 的确定 (最小阻带衰减)67:
    
    $$A=-20\log_{10}(\min\{\delta_{p},\delta_{s}\})$$
    
    (通常取 $A \approx A_s$）68。
    
3. 参数 $\beta$ 的经验公式69:
    
    $$\beta=\begin{cases}0.1102(A-8.7), & A>50 \\ 0.5842(A-21)^{0.4}+0.07886(A-21), & 21\le A\le50 \\ 0, & A<21\end{cases}$$
    
4. 滤波器阶数 $M$ 的经验公式70:
    
    $$M\approx\frac{A-7.95}{2.285|\Omega_{p}-\Omega_{s}|}, \quad A>21$$
    

### 3. 频率取样法设计（小众考点）

#### 3.1 设计思想与步骤

1. 基本思想：基于频域的逼近。使所设计的 $M$ 阶 FIR 滤波器的频率响应 $H(e^{j\Omega})$ 在 $M+1$ 个均匀取样点 $\Omega_m$ 上与理想频率响应 $H_{d}(e^{j\Omega})$ 相等。
    
    $$H(e^{j\Omega_m}) = H_d(e^{j\Omega_m})$$
    
2. 取样点频率:
    
    $$\Omega_{m}=\frac{2\pi}{M+1}m, \quad m=0,1,\cdots,M$$
    
3. **设计步骤（考点）**:
    
    - 1. 由 $H_{d}(e^{j\Omega})$ 确定 FIRDF 的**类型**和幅度函数 $A_{d}(\Omega)$。
            
    - 2. 根据类型确定线性相位 FIR 滤波器的相位 $\varphi_{d}(\Omega)=-0.5M\Omega+\beta$。
            
    - 3. 确定理想频率响应在取样点的值 $H_{d}[m]$:
            
            $$H_{d}[m]=e^{j\beta}e^{-j\frac{M\pi}{M+1}m}A_{d}(\frac{2\pi}{M+1}m)$$
            
    - 4. 对 $H_{d}[m]$ 做 $M+1$ 点 IDFT，得到单位脉冲响应 $h[k]$:
            
            $$h[k]=IDFT\{H_{d}[m]\} = \frac{1}{M+1}\sum_{m=0}^{M}H_{d}[m]e^{j\frac{2\pi mk}{M+1}}$$
            
            71
            

#### 3.2 改进方法（小众点）

1. **问题**：直接取样设计出的滤波器，在通带到阻带的样本点发生从 $1$ 到 $0$ 的跳变，导致幅度响应在过渡带边界出现过冲，在阻带存在较大波动 72。增加滤波器阶数 $M$ 对阻带波动**几乎没有改善** 73。
    
2. **改进**：在**过渡带** $[\Omega_p, \Omega_s]$ 之间设置幅度在 $0$ 和 $1$ 之间的**过渡点**（非零样本点）。
    
    - 过渡点的幅度值 $T_i$ 称为**最优值** 74。
        
    - 设置过渡点可以**减小旁瓣波动**，**提高阻带衰减**。
        

### 4. 优化设计法（小众考点）

#### 4.1 优化设计的原理与准则

1. **基本原理**：在一定的误差准则下，计算 FIR 滤波器的系数 $h[k]$，使得设计的频率响应 $H(e^{j\Omega})$ 与给定理想频率响应 $H_{d}(e^{j\Omega})$ 的误差最小。
    
2. 加权误差函数75:
    
    $$E(\Omega)=W(\Omega)[A(\Omega)-D(\Omega)]$$
    
    其中 $W(\Omega)\ge0$ 是加权函数，$A(\Omega)$ 是设计的幅度函数，$D(\Omega)$ 是理想幅度响应。
    
3. **常用误差准则**767676:
    
    - 1. 最大最小误差准则 (Minimax / Chebyshev 准则)（考点）：
        
        $$\epsilon=\max_{\Omega\in I}|E(\Omega)|$$
        
        77
        
    - 2. 积分加权平方误差准则：
        
        $$\epsilon=\int_{I}[E(\Omega)]^{2}d\Omega$$
        
        78
        
    - 3. 加权离散平方误差准则：
        
        $$\epsilon=\sum_{m=1}^{K}\{E(\Omega_{m})\}^{2}$$
        
        79
        

#### 4.2 Parks-McClellan (PM) 算法（核心考点）

1. **最大最小准则下的设计方法**：PM 算法（Parks-McClellan）或 Remez 算法 8080。
    
2. **特点**：设计出的 FIR 滤波器在通带和阻带都会呈现**等波纹**的波动（等波纹 FIR 滤波器） 81818181。
    
3. 交替定理（小众点）：最佳逼近函数 $G(\Omega)$ 存在的充要条件是，在集合 $I$ 的范围内至少存在 $J+2$ 个极值点 $\Omega_{0}<\Omega_{1}<\cdots<\Omega_{J+1}$，使得：
    
    $$\tilde{W}(\Omega_{k})[G(\Omega_{k})-\tilde{D}(\Omega_{k})]=(-1)^{k}\epsilon, \quad 0\le k\le J+1$$
    
    82
    
    且误差函数的绝对值相等：
    
    $$|\epsilon(\Omega_{k})| [cite_start]= \epsilon, \quad 0\le k\le J+1$$
    
    83
    
4. 滤波器阶数 $M$ 的经验公式（小众点）84:
    
    $$M\approx\frac{-20\log_{10}\sqrt{\delta_{p}\delta_{s}}-13}{2.32|\Omega_{p}-\Omega_{s}|}$$
    

### 5. FIR 与 IIR 数字滤波器的比较（核心考点）

|**特性**|**IIR 数字滤波器 (DF)**|**FIR 数字滤波器 (DF)**|
|---|---|---|
|**稳定性**|不一定稳定 (有极点)|**一定稳定** (极点在原点 $z=0$)|
|**相位特性**|非线性相位|**易于实现线性相位**|
|**设计阶数**|较低|**较高**|
|**幅度响应**|较好|不好 (较难设计)|
|**实现难易程度**|难|易|
|**可用 FFT 实现**|不用|**可用**|
|**适用信号**|对相位要求不高 (如语音)|对相位要求较高 (如图像)|