
1. 数字信号处理的方法：DFS、DTFT、DFT；时域变频域可以更好的分析和描述信号的特性
2. 离散傅里叶变换：
	1. 定义：有限长序列的傅立叶分析
	2. 为什么要有DFT
		1. 四种信号的傅里叶分析回顾（时域信号通过傅立叶变换可以变成频域信号）
			1. 公式：
				1. FT：$x(t) \longrightarrow X(j\omega) = \int_{-\infty}^{+\infty} x(t) e^{-j\omega t} dt$ 
				2. DFT：$x[k] \longrightarrow X(e^{j\Omega}) = \sum_{k=-\infty}^{\infty} x[k] e^{-j\Omega k}= \sum_{k=-\infty}^{\infty} x[k] \cdot \left(e^{j\Omega k}\right)^*$
			2. 文字描述：
				1. FT：连续非周期信号变成连续非周期函数，但是信号的 $x(t)$ 不好找
				2. DFT：离散非周期信号变成连续周期函数，虽然抽样得到每一点 $x[k]$ 的数值，但是得到的是一个连续变量为Ω的函数，无法用数字化的方法计算
		2. 实际应用当中没有通过FT 和DFT 的表达式直接得到信号的频谱
---

# 第2章 离散傅里叶变换 (DFT) 复习笔记

## 1. DFT 的基本概念与定义

### 1.1 四种信号的傅里叶分析回顾

1. **连续周期信号** -> 傅里叶级数 (FS) -> 频谱：离散、非周期
    
2. **连续非周期信号** -> 傅里叶变换 (FT) -> 频谱：连续、非周期
    
3. **离散非周期信号** -> 离散时间傅里叶变换 (DTFT) -> 频谱：连续、周期
    
4. **离散周期信号** -> 离散傅里叶级数 (DFS) -> 频谱：离散、周期
    
    - **【考点】**：只有**离散周期信号**的频谱是离散且周期的，才适合计算机处理。DFT 就是基于 DFS 导出的有限长序列变换。
        

### 1.2 DFT 的定义

设 $x[k]$ 为长度为 $N$ 的有限长序列 ($0 \le k \le N-1$)：

- **正变换 (Analysis):**
    
    $$X[m] = \text{DFT}\{x[k]\} = \sum_{k=0}^{N-1} x[k] W_N^{mk}, \quad m=0, 1, \dots, N-1$$
- **逆变换 (Synthesis):**
    
    $$x[k] = \text{IDFT}\{X[m]\} = \frac{1}{N} \sum_{m=0}^{N-1} X[m] W_N^{-mk}, \quad k=0, 1, \dots, N-1$$
    - 其中旋转因子 $W_N = e^{-j\frac{2\pi}{N}}$。
        
- **物理意义**：DFT 是 DTFT 在频域区间 $[0, 2\pi)$ 上的 $N$ 点等间隔采样。
    
    - **【考点】**：$X[m] = X(e^{j\Omega})|_{\Omega = \frac{2\pi}{N}m}$。
        

## 2. DFT 的主要性质

### 2.1 线性特性

$$DFT\{a x_1[k] + b x_2[k]\} = a X_1[m] + b X_2[m]$$

- 注意：若两序列长度不同，需补零至相同长度（通常取较长者的长度）。
    

### 2.2 循环位移 (Circular Shift)

- **时域循环位移**：
    
    $$x[(k+n)_N] \leftrightarrow W_N^{-mn} X[m]$$
    - **【考点】**：理解“循环”的概念，即序列首尾相接。左移溢出的部分会从右边补回来。
        
    - **【小众点】**：计算 $(k-2)_5$ 时，若结果为负，需加 $N$ 直至为正。例如 $N=5$，$(0-2)_5 = -2 \rightarrow 3$。
        
- **频域循环位移**：
    
    $$W_N^{lk} x[k] \leftrightarrow X[(m+l)_N]$$

### 2.3 对称特性 (重要)

- **共轭对称性**： 若 $x[k]$ 为实序列，则 $X[m]$ 满足**共轭对称**：
    
    $$X[m] = X^*[ (N-m)_N ]$$
    
    即：幅度谱偶对称 $|X[m]| = |X[N-m]|$，相位谱奇对称 $\phi[m] = -\phi[N-m]$。
    
- **【考点】**：利用对称性减少计算量，只需计算前 $N/2 + 1$ 个点。
    
- **【小众点】**：
    
    - 实偶对称序列的 DFT 是实偶对称序列。
        
    - 实奇对称序列的 DFT 是纯虚奇对称序列（注意 $x[0]=0$）。
        

### 2.4 循环卷积定理

- **时域循环卷积**：
    
    $$x_1[k] \otimes x_2[k] \leftrightarrow X_1[m] \cdot X_2[m]$$
- **频域循环卷积**：
    
    $$x_1[k] \cdot x_2[k] \leftrightarrow \frac{1}{N} X_1[m] \otimes X_2[m]$$
- **【考点】**：循环卷积的计算方法（矩阵法、同心圆法）。注意循环卷积长度必须等于 DFT 点数 $N$。
    

### 2.5 Parseval 定理 (能量守恒)

$$\sum_{k=0}^{N-1} |x[k]|^2 = \frac{1}{N} \sum_{m=0}^{N-1} |X[m]|^2$$

## 3. 利用 DFT 计算线性卷积

### 3.1 为什么要用 DFT 计算？

- 直接计算线性卷积复杂度为 $O(N^2)$，利用 FFT (快速傅里叶变换) 复杂度为 $O(N \log N)$。当 $N$ 很大时，效率提升显著。
    

### 3.2 计算步骤与条件

1. 设 $x[k]$ 长 $N_1$，$h[k]$ 长 $N_2$。
    
2. 线性卷积 $y[k]$ 的长度为 $N_1 + N_2 - 1$。
    
3. **【考点 - 核心条件】**：必须对序列进行**补零**，使得 DFT 点数 $L$ 满足：
    
    $$L \ge N_1 + N_2 - 1$$
    
    此时，**循环卷积的结果 = 线性卷积的结果**。
    
4. 若 $L < N_1 + N_2 - 1$，循环卷积会导致时域**混叠** (Aliasing in time domain)，结果错误。
    

### 3.3 长序列与短序列的卷积

当 $x[k]$ 很长，无法一次性处理时，采用**分段卷积**：

1. **重叠相加法 (Overlap-Add)**：
    
    - 将长序列分段，每段长度 $L$。
        
    - 各段分别与 $h[k]$ 卷积（补零后）。
        
    - **【考点】**：相邻段卷积结果有 $M-1$ 个点重叠（$M$ 为 $h[k]$ 长度），需将重叠部分**相加**。
        
2. **重叠保留法 (Overlap-Save)**：
    
    - 输入分段时，每段与前一段重叠 $M-1$ 个点。
        
    - 计算循环卷积。
        
    - **【考点】**：输出时，**丢弃**每段开头的 $M-1$ 个点（这些点是混叠错误的），保留剩余部分拼接。
        

## 4. 利用 DFT 分析连续信号频谱 (核心难点)

利用 DFT 分析 $x(t)$ 的频谱 $X(j\omega)$ 时，会涉及三个主要误差/现象：

### 4.1 混叠现象 (Aliasing)

- **原因**：时域采样导致频域周期延拓。若信号不是带限的，或采样频率 $f_{sam}$ 过低，延拓的频谱会重叠。
    
- **对策**：
    
    1. 满足采样定理：$f_{sam} \ge 2 f_{max}$。
        
    2. 采样前加**抗混叠滤波器** (低通滤波)。
        

### 4.2 泄漏现象 (Leakage)

- **原因**：时域截断（加窗）。
    
    - 实际信号往往是无限长的，DFT 只能处理有限长，相当于乘以窗函数 $w[k]$。
        
    - 时域乘积 = 频域卷积：$X_{N}(e^{j\Omega}) = X(e^{j\Omega}) * W(e^{j\Omega})$。
        
    - 窗函数的**旁瓣**导致能量泄漏到其他频率。
        
- **影响**：原有的谱线变宽（由主瓣宽度决定），可能掩盖邻近的弱信号（由旁瓣高度决定）。
    
- **窗函数对比**：
    
    - **矩形窗**：主瓣窄 ($4\pi/N$)，但旁瓣高 (-13dB)。分辨率高，但泄漏严重。
        
    - **汉明窗 (Hamming)**：主瓣宽 ($8\pi/N$)，旁瓣低 (-41dB)。分辨率低，但泄漏少。
        
    - **【小众点】**：矩形窗主瓣有效宽度定义为 $2\pi/N$，而汉明窗/汉宁窗通常认为是 $4\pi/N$（基于零点或主瓣宽度计算方式不同，注意课件中的 $\Delta\Omega_w$ 定义）。
        
- **对策**：
    
    1. 增加截取长度 $N$（使主瓣变窄，提高分辨率）。
        
    2. 选择旁瓣衰减大的非矩形窗（如 Hamming, Blackman）。
        

### 4.3 栅栏现象 (Picket-Fence Effect)

- **原因**：DFT 只是频谱的离散采样。就像透过栅栏看风景，可能漏掉栅栏（采样点）之间的频谱峰值。
    
- **谱线间隔**：$\Delta f_d = \frac{f_{sam}}{N}$。
    
- **对策**：**补零 (Zero Padding)**。
    
    - **【考点】**：补零**不能**提高物理分辨率（分辨两个靠得很近的频率的能力），物理分辨率只取决于由于信号采集时长 $T_p$。
        
    - 补零只能提高**显示分辨率**（谱线更密），让我们看到频谱的更多细节，减小栅栏效应。
        

## 5. 参数选择与计算公式 (计算题核心)

在进行频谱分析时，参数选择至关重要：

1. **最高频率** $f_m$：决定采样频率。
    
    - $f_{sam} \ge 2 f_m$
        
2. **频率分辨率** $\Delta f_c$ (Resolving Power)：分辨两个频率分量的能力。
    
    - 取决于主瓣宽度，即取决于采集时长 $T_p$。
        
    - 矩形窗条件下：$\Delta f_c \approx \frac{1}{T_p} = \frac{1}{N T} = \frac{f_{sam}}{N}$。
        
    - **【考点】**：若要求分辨 $100Hz$ 和 $105Hz$，则 $\Delta f_c \le 5Hz$。需满足 $T_p \ge 1/5 = 0.2s$。
        
3. **谱线间隔** $\Delta f_d$ (Display Resolution)：DFT 输出点之间的频率间隔。
    
    - $\Delta f_d = \frac{f_{sam}}{L}$ （其中 $L$ 是 DFT 计算点数，可能大于数据长度 $N$，即补零后）。
        
    - 若要求观察细节，需 $\Delta f_d$ 足够小。
        

### 【总结公式表】

|参数|符号|约束条件/公式|备注|
|---|---|---|---|
|**采样频率**|$f_{sam}$|$\ge 2f_{max}$|防止混叠|
|**采集时间**|$T_p$|$\ge 1 / \Delta f_{req}$|决定物理分辨率 (主瓣宽度)|
|**数据长度**|$N$|$N = T_p \times f_{sam}$|实际采样点数|
|**DFT点数**|$L$|$L \ge N$ (通常取2的幂)|决定谱线间隔 $\Delta f_d = f_{sam}/L$|

## 6. 其他知识点 (补充)

- **MATLAB 函数**：
    
    - `fft(x, N)`: 计算 N 点 DFT。若 x 长度小于 N，自动补零。
        
    - `fftshift`: 将零频分量移到频谱中心（通常用于画图）。
        
    - **【小众点】**：`fft` 计算结果也是从 $0$ 到 $N-1$，对应频率 $0$ 到 $f_s$。前半部分对应正频，后半部分对应负频。
        
- **应用举例**：
    
    - **听歌识曲**：利用 DFT 分析音频片段的频谱特征（指纹）进行匹配。
        
    - **DTMF (双音多频)**：电话拨号音识别，利用 DFT 检测特定的两个频率组合。