
1. 数字信号处理的方法：DFS、DTFT、DFT；时域变频域可以更好的分析和描述信号的特性
2. 离散傅里叶变换：
	1. 定义：有限长序列的傅立叶分析
	2. 为什么要有DFT
		1. 四种信号的傅里叶分析回顾（时域信号通过傅立叶变换可以变成频域信号）
			1. 公式：
				1. CTFT：$x(t) \longrightarrow X(j\omega) = \int_{-\infty}^{+\infty} x(t) e^{-j\omega t} dt$ 
				2. FS：$\tilde{x}(t)\longrightarrow X(n\omega_0) = \frac{1}{T} \int_{0}^{T} \tilde{x}(t)e^{-jn\omega_0 t} dt$
				3. DTFT：$x[k] \longrightarrow X(e^{j\Omega}) = \sum_{k=-\infty}^{\infty} x[k] e^{-j\Omega k}= \sum_{k=-\infty}^{\infty} x[k] \cdot \left(e^{j\Omega k}\right)^*$
				4. DFS：$\tilde{x}[k] \longrightarrow \tilde{X}[m] = \sum_{k=0}^{N-1} \tilde{x}[k]e^{-j\frac{2\pi}{N}mk}$
			2. 文字描述：
				1. CTFT：连续非周期信号-->连续非周期函数，但是信号的 $x(t)$ 不好找
				2. FS：连续周期-->离散非周期，$\tilde{x}(t)$ 也不好找
				3. DTFT：离散非周期信号-->连续周期函数，虽然抽样得到每一点 $x[k]$ 的数值，但是得到的是一个连续变量为Ω的函数，无法用数字化的方法计算
				4. DFS：离散周期信号-->离散周期信号只有这个表达式可以直接进行计算🧚‍♀️电脑上画出的线不是真的连续的，都是在极小的间隔下取样拟合的
		2. 实际应用当中没有通过FT 、FS和DTFT 的表达式直接得到信号的频谱。只有**离散周期信号**的频谱是离散且周期的，才适合计算机处理。DFT 就是基于 DFS 导出的有限长序列变换
		3. 将前面三种信号转换成离散周期信号的频谱分析/建立四种信号频谱之间的关系 ：
		 $\begin{align*} \text{时域的离散化} & \xleftrightarrow{\text{时域抽样定理}} \text{频域周期化} \\[1em] \text{时域的周期化} & \xleftrightarrow{\text{频域抽样定理}} \text{频域离散化} \end{align*}$ 总结：一个域的离散代表另一个域的周期延拓 ![[Pasted image 20251129205633.png|300]] 只有第四行的频谱可以用数字化的方式直接进行计算，所以如果想求 $x (t)$ 的频谱，可以用第四行的频谱来反映原来信号频谱的轮廓，在实际信号的频谱分析不一定需要每一个点的值，只需要看出信号频谱的频率分量分布情况即可 
			1. $$\begin{array}{ccc} x(t) & \xrightarrow{\text{时域抽样}} & x[k] \\ \downarrow & & \downarrow \\ X(\mathrm{j}\omega) & \longrightarrow & X(\mathrm{e}^{\mathrm{j}\Omega}) \end{array}$$
			2. $$\begin{array}{ccc} X(\mathrm{e}^{\mathrm{j}\Omega}) & \xrightarrow{\text{频域抽样}} & \tilde{X}[m] \\ \downarrow & & \downarrow \\ x[k] & \longrightarrow & \tilde{x}[k] \end{array}$$
		4. DFS 是周期序列，描述上麻烦，所以引入有限长序列。由于周期序列每一个周期的值是一样的，所有只需要分析一个周期的情况即可
			1. DFS：整个周期上定义的 $\tilde{X}[m] = \sum_{k=0}^{N-1} \tilde{x}[k]e^{-j\frac{2\pi}{N}mk}$
			2. DFT：${X}[m] = \sum_{k=0}^{N-1} {x}[k]e^{-j\frac{2\pi}{N}mk}$ $0 \leq m \leq N-1$ Discrete Fourier Transform 离散傅立叶变换，将一个周期的值取出来定义为DFT：周期序列截断为有限长序列
			3. IDFS：$\tilde{x}[k] = \frac{1}{N} \sum_{m=0}^{N-1} \tilde{X}[m] e^{j\frac{2\pi}{N}mk}$
			4. IDFT：$x[k] = \frac{1}{N} \sum_{m=0}^{N-1} X[m] e^{j\frac{2\pi}{N}mk}$ $0 \leq m \leq N-1$ DFT 的逆变换
			【总结】DFT 是 DFS 在一个周期内的取值，IDFT 是 IDFS 在一个周期内的取值
3. DFT ：有限长傅立叶变换
	1. 定义：设 $x[k]$ 为长度为 $N$ 的有限长序列 ($0 \le k \le N-1$)：
		1. **正变换 (Analysis):** $X[m] = \text{DFT}\{x[k]\} = \sum_{k=0}^{N-1} x[k] W_N^{mk}, \quad m=0, 1, \dots, N-1$
		2. **逆变换 (Synthesis):** $x[k] = \text{IDFT}\{X[m]\} = \frac{1}{N} \sum_{m=0}^{N-1} X[m] W_N^{-mk}, \quad k=0, 1, \dots, N-1$
			- 其中~={red} **旋转因子 $W_N = e^{-j\frac{2\pi}{N}}$** =~
		$$ \boxed{ \begin{aligned} X[m] &= \text{DFT}\{x[k]\} \\ x[k] &= \text{IDFT}\{X[m]\} \end{aligned} } \qquad x[k] \xleftrightarrow{\text{DFT}} X[m] $$
	2. **物理意义**：DFT 是 DTFT 在频域区间 $[0, 2\pi)$ 上的 $N$ 点等间隔采样。
		- **【考点】**：$X[m] = X(e^{j\Omega})|_{\Omega = \frac{2\pi}{N}m}$。
	3. 应用：进行信号频谱的分析/信号的其他处理（计算信号的卷积）
	4. 联系：DFT 既是 DFS 取一个周期（时域视角），也是 DTFT 的频域离散采样（频域视角）。
		1. DFT🆚DTFT：一个序列的 DFT 即该序列频谱在一个周期内等间隔抽样的样点值，可以通过 DFT 观察序列频谱在一个周期内的样点，从而分析信号的频谱
	5. DFT 计算：
		1. 计算次数：$n^2$ 次复数乘积运算
		2. 矩阵表示：
			1. 原理：DFT 实际上是一个线性变换。
			2. 核心公式： $\mathbf{X} = \mathbf{W}_N \cdot \mathbf{x}$
				- **$\mathbf{x}$**：时域信号列向量 ($N \times 1$)
				- **$\mathbf{X}$**：频域信号列向量 ($N \times 1$)
				- **$\mathbf{W}_N$**：DFT 变换矩阵 ($N \times N$)，也叫**旋转因子矩阵**。
			3. 变换矩阵 $\mathbf{W}_N$ 的构造（矩阵第 $k$ 行、第 $n$ 列的元素为 $W_N^{kn}$ 且注意行列索引从 0 开始）$$\mathbf{W}_N = \begin{bmatrix} W_N^{0\cdot0} & W_N^{0\cdot1} & \cdots & W_N^{0\cdot(N-1)} \\ W_N^{1\cdot0} & W_N^{1\cdot1} & \cdots & W_N^{1\cdot(N-1)} \\ \vdots & \vdots & \ddots & \vdots \\ W_N^{(N-1)\cdot0} & W_N^{(N-1)\cdot1} & \cdots & W_N^{(N-1)\cdot(N-1)} \end{bmatrix}$$
			4. $W^{kn}$ 的性质：
				1. $W_4^{k+4} = W_4^k$
				2. $W^{kn} = W^{nk}$
				3. 范德蒙矩阵：矩阵的每一行（或每一列）都是一个**等比数列**
		3. $n$ 点序列 DFT 也是 $n$ 点。
			1. 若序列补 0，且总长度是原长度的整数倍，DFT 得到的序列依然有原来的序列的元素，因为新的采样点，能踩在旧的采样点的位置上
			2. 序列补 0，可以获得更多抽样值，观察到 $X(e^{j\Omega})$ 的更多细节（补零并没有增加新的信息，只是让频域变得“更密集”）
			3. 补零没有改变信号包含的信息（DTFT包络形状不变），但改变了我们在频域观察它的‘视力’（DFT采样密度变密）。
			4. **补零的效果：** 叫**频域插值（Interpolation）**，只是让曲线变平滑（连点成线点的密度变大了），看清**已经存在**的细节，不能创造新的细节。
			5. 真正的分辨率： 取决于非零数据的长度（观察窗口的时间长度）。如果你只录了 0.1 秒的声音，无论你后面补多少个 0，你都分不清 100Hz 和 101Hz。
	6. DFT 的主要性质
		1. 线性特性：$DFT\{a x_1[k] + b x_2[k]\} = a X_1[m] + b X_2[m]$ 
			- 注意：若两序列长度不同，需补零至相同长度（通常取较长者的长度）。
		2. 循环位移 (Circular Shift)
			1. **时域循环位移**：$x[(k+n)_N] \leftrightarrow W_N^{-mn} X[m]$
				1. 符号 $(k)_N$: 表示对 $k$ 以 $N$ 进行模运算，即除以 $N$ 得到的余数，结果一定是 $0$ 到 $N-1$ 的一个值（🧚‍♀️其实就是 $k\% N$，奥本海姆喜欢写下标，这也是更数学、更传统的表示方法）
				2. 运算：若 $k = k_1 + k_2N, \quad k_1 = 0, 1, \cdots, N-1, \quad k_2 \in \mathbf{Z}$，则 $(k)_N = k_1 \qquad (k)_N = (k+N)_N = k_1$ 周期化的序列进行位移等效于循环位移🧚‍♀️计算机里是对索引取模运算来检索 $x[n]$ 数组的值，形成循环序列或者说类似对 $x[n]$ 圆周位移，实际像一个队列的思想，用**有限的队列来循环，模拟无限周期性，也是隐藏周期性的体现**
					1. ⚠️计算 $(k-2)_5$ 时，若结果为负，需加 $N$ 直至为正。例如 $N=5$，$(0-2)_5 = -2 \rightarrow 3$。
				3. 循环位移：将序列周期化，周期化的序列进行平移（**本质：DFT 是 DFS 在一个周期内的运算，他们本质上是一致的**）
				4. 公式：$x[(k+n)_N] \xleftrightarrow{\text{DFT}} W_N^{-mn} X[m]$
					1. 文字：时域的循环位移对应频域的相移
					2. DFS：时域的位移对应频域的相移
			2. **频域循环位移**：$W_N^{lk} x[k] \xleftrightarrow{\text{DFT}} X[(m+l)_N]$
		3. 对称特性 **(重要)**
			1. **共轭对称性**： 
				1. **周期共轭对称**: $x[k] = x^*[(-k)_N] = x^*[(N-k)_N]$
				2. **周期共轭反对称**: $x[k] = -x^*[(-k)_N] = -x^*[(N-k)_N]$
					若 $x[k]$ 为**实序列**（周期即将有限序列周期化）（DFT 就是 DFS 在一个周期内的主值范围==>DFT 的点数 $N$，定义了循环卷积的“周期”）
						1. 周期偶对称：$x[k] = x[(-k)_N] = x[(N-k)_N]$ 🧚‍♀️一个周期内找相等就是为了周期延拓后与下一个周期内对应位置的相等，这是有数理逻辑的；$K_1+k_2=N$，然后再用奇偶行去套就行了。模运算就是离散周期化的方式，就把这个下标理解为 N 为周期就行；就是在说：如何判断一个周期内 DFT 是偶对称？周期延拓后看 DFS 是不是偶对称就知道了。奇对称同理![[截屏2025-11-30 14.34.55.png]] ![[Pasted image 20251130143526.png]]
						2. 周期奇对称：$x[k] = -x[(-k)_N] = -x[(N-k)_N]$
							- 一定为 0 的点
								1. $n=0$ ，即第一个点，直流分量
								2. 如果序列长度 $N$ 是**偶数**，还有一个点也必须是 0==>$n = N/2$(即奈奎斯特频率点)![[截屏2025-11-30 14.50.59.png]]
					2.  DFT 之后频谱的关系：若 $x[k] \overset{\text{DFT}}{\longleftrightarrow} X[m]$，则 $x^*[k] \overset{\text{DFT}}{\longleftrightarrow} X^*[(-m)_N]$，$\quad x^*[(-k)_N] \overset{\text{DFT}}{\longleftrightarrow} X^*[m]$
						若 $x[k]$ 为**实序列** $x[k]=x^*[k]$
						1. $X[m]$ 满足**共轭对称**：~={red} $X[m] = X^*[ (-m)_N ]= X^*[ (N-m)_N ]$ =~
						2. DFT 的 $X[m]$ 用幅度和相位来表示：
							1. 幅度谱偶对称 $|X[m]| = |X[N-m]|$
							2. 相位谱奇对称 $\phi[m] = -\phi[N-m]$。
						3. DFT 的 $X[m]$ 用实部和虚部来表示：
							1. 实部偶对称：$X_R[m] = X_R[N-m]$
							2. 虚部奇对称：$X_I[m] = -X_I[N-m]$
			2. **【考点】**：利用对称性减少计算量，实序列只需计算前 $N/2 + 1$ 个点，另一半可以通过对称性获得
			3. 实偶对称序列的 DFT 是实偶对称序列；实奇对称序列的 DFT 是纯虚奇对称序列（注意 $x[0]=0$）。
		4. 循环卷积定理
			1. **时域循环卷积**：$x_1[k] \otimes x_2[k] \leftrightarrow X_1[m] \cdot X_2[m]$ 
				- 循环卷积和线性卷积的关系：循环卷积是线性卷积在时域上的“混叠”（Aliasing）结果；如果补足够多的 0，循环卷积的结果就等于线性卷积。
					1. 线性卷积 ：$N_1 + N_2 - 1$ 信号滑出去就滑出去了，不会回来。
					2. 循环卷积：**$N$** (即 DFT 的点数)，信号滑出这一头，会立刻从另一头钻出来（周期延拓）。
					3. 混叠现象：线性卷积的结果是一条长长的蛇，长度是 $N_1 + N_2 - 1$。现在的任务是：**把这条长蛇塞进一个只有 $N$ 长度的盒子里（做 $N$ 点循环卷积）。
						1. **如果 $N \ge N_1 + N_2 - 1$（盒子够大）：** 蛇可以完整地放进去，不需要弯曲。 **结论：** 此时，循环卷积 **=** 线性卷积。DFT 存在相应的快速算法，可以用 DFT 计算线性卷积
						2. **如果 $N < N_1 + N_2 - 1$（盒子太小）：** 蛇太长了，尾巴露在外面怎么办？根据 DFT 的周期性，**尾巴会绕回来，叠加到头部去**。这就是**时域混叠**。 **结论：** 此时，循环卷积 **$\neq$** 线性卷积（头部的数据被尾巴污染了）。
			2. **频域循环卷积**：$x_1[k] \cdot x_2[k] \leftrightarrow \frac{1}{N} X_1[m] \otimes X_2[m]$
			-  **【考点】**：循环卷积的计算方法（矩阵法、同心圆法）。注意循环卷积长度必须等于 DFT 点数 $N$
	    5. Parseval 定理 (能量守恒)： $\sum_{k=0}^{N-1} |x[k]|^2 = \frac{1}{N} \sum_{m=0}^{N-1} |X[m]|^2$
	7. 利用 DFT 计算线性卷积
		1. 为什么要用 DFT 计算？
			- 直接计算线性卷积复杂度为 $O(N^2)$，利用 FFT (快速傅里叶变换) 复杂度为 $O(N \log N)$。当 $N$ 很大时，效率提升显著
			- 当序列长度相当，通过循环卷积和 DFT（FFT）计算效率会提高；长序列和短序列线性卷积的时候，通过循环卷积和 DFT 计算反而效率会降低或效率提高有限（短序列被补了大量的零（$N-M$ 个零），对这些零进行 FFT 运算是对计算资源的巨大浪费。）
	    2. 计算步骤与条件
			1. 设 $x[k]$ 长 $N_1$，$h[k]$ 长 $N_2$。
			2. 线性卷积 $y[k]$ 的长度为 $N_1 + N_2 - 1$。
			3. **【考点 - 核心条件】**：必须对序列进行**补零**，使得 DFT 点数 $L$ 满足：$L \ge N_1 + N_2 - 1$此时，**循环卷积的结果 = 线性卷积的结果**。
			4. 若 $L < N_1 + N_2 - 1$，循环卷积会导致时域**混叠**，结果错误。
		 3. **长序列与短序列**的卷积（实际工程中大量存在，输入序列长但是系统单位脉冲响应 $h[k]$ 比较短）
			- **直接利用 DFT 计算长序列与短序列的卷积，存在缺点：**
				(1) 信号要全部输入后才能进行计算，延迟太多；
				(2) 内存要求较大；
				(3) 算法效率不高。
			当 $x[k]$ 很长，无法一次性处理时，采用**分段卷积**（对长序列进行相应的处理）：
			PS: $M$ 是短序列的长度 
			1. **重叠相加法 (Overlap-Add)**：
			    - 将长序列分段，每段长度 $L$。
			    - 各段分别与 $h[k]$ 卷积（补零后）。
			    - **【考点】**：相邻段卷积结果有 $M-1$ 个点重叠（$M$ 为 $h[k]$ 长度），需将重叠部分**相加**。![[截屏2025-11-30 17.01.38.png]]
			2. **重叠保留法 (Overlap-Save)**：
			    - 输入分段时，每段与前一段重叠 $M-1$ 个点。
			    - 计算循环卷积。
			    - **【考点】**：输出时，**丢弃**每段开头的 $M-1$ 个点（这些点是混叠错误的），保留剩余部分拼接。![[IMG_E476EE398EEF-1.jpeg|]]
	8. 利用 DFT 分析连续信号频谱 **(核心难点)**
		0. 一些知识点：
			1. 信号之间的关系 ：离散即抽样，有限长信号 $x(t)$ 抽样变成有限长序列 $x[k]$ $$\begin{array}{ccccc}x(t) & \xrightarrow{\hspace{1em}\text{离散化}\hspace{1em}} & x[k] & \xrightarrow{\hspace{1em}\text{周期化}\hspace{1em}} & \tilde{x}[k] \\\Big\downarrow & & \Big\downarrow & & \Big\downarrow \text{\small DFT} \\X(\mathrm{j}\omega) & \xrightarrow{\hspace{1em}\text{周期化}\hspace{1em}} & X(\mathrm{e}^{\mathrm{j}\Omega}) & \xrightarrow{\hspace{1em}\text{离散化}\hspace{1em}} & \tilde{X}[m] \end{array} $$
				1. 抽样定理（频域混叠） $X(e^{j\Omega}) = \frac{1}{T} \sum_{n=-\infty}^{\infty} X[j(\omega + n\omega_{sam})]$ 
					- $x[n] = x(t) \Big|_{t=nT} = x(nT)$
				2. 频域抽样定理 $X[m] = X(e^{j\Omega}) \bigg|_{\Omega = \frac{2\pi}{N}m}, \quad m = 0, \dots, N-1$
			2. $\omega_{sam}$： 在数字频域中，模拟采样频率 $\omega_{sam}$ 被映射成了 $2\pi$。
			3. 一个有限长序列 DFT 是 DTFT （即该序列的真实频谱）在一个周期内的抽样，做了 $n$ 点的 DFT 就相当于对 DTFT 得到的频谱在一个周期 $2\pi$ 之内均匀的采样了 $n$ 个样点，每一个间隔是 $2\pi/N$
			4. 如果采样频率和被采样信号的频率一样的话，相邻采样点之间相位间隔是 $2\pi$
			5. 8hz的采样率下 1600个采样点有3分多钟（$T = \frac{1600}{8} = 200 \text{ 秒}$）
		1. 重要公式：
			1. **$f_{sam}$** (采样频率)：表示每秒采多少个点，即每秒钟抓取多少个数据点。$f_{sam} = 1 / T_{sam}$（这里的 $T_{sam}$ 是两个采样点之间的**时间间隔**，即采样周期）
			2. **$\Omega$** (有时写作 $\hat{\omega}$ 或 $\theta$)（数字角频率）：每采一个点，相位转了多少度；~={red}**归一化**=~频率 ~={red} $\Omega = \omega \cdot T_{sam}=2\pi\frac{f}{f_{sam}}=2\pi\frac{w}{w_{sam}}$ =~
		利用 DFT 分析 $x(t)$ 的频谱 $X(j\omega)$ 时，会涉及三个主要误差/现象：（非理论问题，是实际应用的工程问题）（‼️工程实际当中不存在频带和时间都有限的信号🧚‍♀️时频域不能同时为有限）（~={orange}**“突变”需要无限的频率，而“平滑”需要无限的时间。** 数学不允许你既有完美的“突变”（时限），又有完美的“平滑”（频限）。工程上全是妥协的艺术=~）
		2. 混叠现象：$$x(t) \xrightarrow{\color{red}{\text{抗混叠}}} x[k] \xrightarrow{\color{green}{\text{抽样}}} x_N[k] \xrightarrow{\color{purple}{\textbf{DFT}}} X[m]$$
			- **原因**：时域采样导致频域周期延拓。若信号不是带限的，或采样频率 $f_{sam}$ 过低，延拓的频谱会重叠。
			- 误差
				1. **截断误差**：“只看了一部分”（时长不够）导致
				2. **混叠误差**：“看的不够快”（采样太稀）导致‼️减少抽样间隔（减小抽样间隔就相当于增大抽样频率，这样可以抽样的频带就更多了）
			- **对策**：
			    1. 满足采样定理：$f_{sam} \ge 2 f_{max}$。
			    2. 采样前加**抗混叠滤波器** (低通滤波)。
		3. 泄漏现象：$$x(t) \xrightarrow{\color{green}{\text{抽样}}} x[k] \xrightarrow{\color{red}{\text{加窗}}} x_N[k] \xrightarrow{\color{purple}{\textbf{DFT}}} X[m]$$
			- **原因**：时域截断（加窗） $x_N[k]=x[k]w_N[k]$
			    - 实际信号往往是无限长的，DFT 只能处理有限长，相当于乘以窗函数 $w[k]$ ==>乘上窗函数是无限长序列变成有限长序列
			    - 时域乘积 = 频域周期卷积：$X_{N}(e^{j\Omega}) = X(e^{j\Omega}) * W(e^{j\Omega})$（$x[k]、w_N[k]$ 的频谱都是 $2\pi$ 为周期的，所以是周期卷积）
			    - 窗函数的**旁瓣**导致能量泄漏到其他频率。
			- **影响**：原有的谱线变宽（由主瓣宽度决定），可能掩盖邻近的弱信号（由旁瓣高度决定）。
				- 信号 $x[k]$ 加窗变成 $x_N[k]$ ，频谱怎么变？![[截屏2025-12-01 09.53.44.png]]
				【答】前面两个波形卷积之后，频谱展宽-->频率泄漏
				- 主瓣的有效宽度：到主瓣的第一个零点处 $\color{blue}{\Delta\Omega_{\text{w}} = \frac{2\pi}{N}}$（有效宽度只算正频率部分，主瓣宽度 $4\pi/N$）
				-   频谱分辨率（模拟频率的分辨率）：$\color{blue}{\Delta\omega_{\text{c}} = \Delta\Omega_{\text{w}} / T = \frac{2\pi}{NT}}$，$\color{blue}{\Delta f_{\text{c}} = \Delta\omega_{\text{c}} / 2\pi = \frac{1}{NT}}$ 与信号采样时间 $T_p$ 是一个倒数关系
				- 信号采样时间： $\color{blue}{T_{\text{p}} = NT = \frac{1}{\Delta f_{\text{c}}}}$
			- **窗函数对比**：思考窗函数对利用 DFT 分析频谱过程中的信号进行加窗截短之后频谱产生的改变 （即频谱泄漏的现象）
			    - **矩形窗**：$w_N[k] = R_N[k] = \begin{cases} 1 & 0 \le k \le N-1 \\ 0 & \text{others} \end{cases}$，$W_N(e^{j\Omega}) = \frac{\sin(N\Omega/2)}{\sin(\Omega/2)} e^{-j\frac{N-1}{2}\Omega}$ （DTFT 是矩形窗的频谱，是周期性 Sa函数，频谱幅度谱如下）主瓣窄 ($4\pi/N$)，但旁瓣高 (-13dB)。分辨率高，但泄漏严重🧚‍♀️时域突变频谱就有高频分量；你把他理解成加了窗函数就变成时限函数，对应的频谱就是无限，所以有高频分量。![[截屏2025-12-01 09.44.41.png]] $\left| \frac{W(e^{j3\pi/N})}{W(e^{j0})} \right| = \left| \frac{\sin(3\pi/2)}{N \sin(3\pi/2N)} \right| \approx \frac{2}{3\pi}$ 频谱第一个旁瓣和主瓣的峰值之比
				    - 旁瓣峰值衰耗 $A = -20 \lg \left| \frac{W(e^{j3\pi/N})}{W(e^{j0})} \right| \approx \color{red}{13.46 \text{ dB}}$
					PS：dB 不是一个物理量（像米、秒、克），而是一个“比例关系”的对数表达形式。$1,000,000$ 倍 $\rightarrow$ $60 \text{ dB}$，$0.000001$ 倍 $\rightarrow$ $-60 \text{ dB}$
			    - **汉明窗 (Hamming)**：主瓣宽 ($8\pi/N$)，旁瓣低 (-41dB)。分辨率低，但泄漏少。
			    - **【小众点】**：矩形窗主瓣有效宽度定义为 $2\pi/N$，而汉明窗/汉宁窗通常认为是 $4\pi/N$（基于零点或主瓣宽度计算方式不同，注意课件中的 $\Delta\Omega_w$ 定义）。
			- **对策**：
			    1. 增加截取长度 $N$（使主瓣变窄，提高分辨率）。
			    2. 选择旁瓣衰减大的非矩形窗（如 Hamming, Blackman）。
		 4. 栅栏现象 (Picket-Fence Effect)
			- **原因**：DFT 只是频谱的离散采样。就像透过栅栏看风景，可能漏掉栅栏（采样点）之间的频谱峰值。
			- **谱线间隔**：$\Delta f_d = \frac{f_{sam}}{N}$。
			- **对策**：**补零 (Zero Padding)**。
			    - **【考点】**：补零**不能**提高物理分辨率（分辨两个靠得很近的频率的能力），物理分辨率只取决于由于信号采集时长 $T_p$。
			    - 补零只能提高**显示分辨率**（谱线更密），让我们看到频谱的更多细节，减小栅栏效应。
## 5. 参数选择与计算公式 (计算题核心)

在进行频谱分析时，参数选择至关重要：

1. **最高频率** $f_m$：决定采样频率。
    
    - $f_{sam} \ge 2 f_m$
        
2. **频率分辨率** $\Delta f_c$ (Resolving Power)：分辨两个频率分量的能力。
    
    - 取决于主瓣宽度，即取决于采集时长 $T_p$。
        
    - 矩形窗条件下：$\Delta f_c \approx \frac{1}{T_p} = \frac{1}{N T} = \frac{f_{sam}}{N}$。
        
    - **【考点】**：若要求分辨 $100Hz$ 和 $105Hz$，则 $\Delta f_c \le 5Hz$。需满足 $T_p \ge 1/5 = 0.2s$。
        
3. **谱线间隔** $\Delta f_d$ (Display Resolution)：DFT 输出点之间的频率间隔。
    
    - $\Delta f_d = \frac{f_{sam}}{L}$ （其中 $L$ 是 DFT 计算点数，可能大于数据长度 $N$，即补零后）。
        
    - 若要求观察细节，需 $\Delta f_d$ 足够小。
        

### 【总结公式表】

|参数|符号|约束条件/公式|备注|
|---|---|---|---|
|**采样频率**|$f_{sam}$|$\ge 2f_{max}$|防止混叠|
|**采集时间**|$T_p$|$\ge 1 / \Delta f_{req}$|决定物理分辨率 (主瓣宽度)|
|**数据长度**|$N$|$N = T_p \times f_{sam}$|实际采样点数|
|**DFT点数**|$L$|$L \ge N$ (通常取2的幂)|决定谱线间隔 $\Delta f_d = f_{sam}/L$|

## 6. 其他知识点 (补充)

- **MATLAB 函数**：
    
    - `fft(x, N)`: 计算 N 点 DFT。若 x 长度小于 N，自动补零。
        
    - `fftshift`: 将零频分量移到频谱中心（通常用于画图）。
        
    - **【小众点】**：`fft` 计算结果也是从 $0$ 到 $N-1$，对应频率 $0$ 到 $f_s$。前半部分对应正频，后半部分对应负频。
        
- **应用举例**：
    
    - **听歌识曲**：利用 DFT 分析音频片段的频谱特征（指纹）进行匹配。
        
    - **DTMF (双音多频)**：电话拨号音识别，利用 DFT 检测特定的两个频率组合。